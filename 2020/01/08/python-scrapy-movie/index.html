<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="Python实现可视化界面多线程豆瓣电影信息爬虫，并绘制统计图分析结果, KuroNekoNeko&#39;s World">
    <meta name="description" content="完整代码见链接：https://github.com/kuronekonano/python_scrapy_movie实现时使用图形界面、多线程、文件操作、数据库编程、网络编程、统计绘图六项技术。1. 数据采集（1）用wxPython实现G">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Python实现可视化界面多线程豆瓣电影信息爬虫，并绘制统计图分析结果 | KuroNekoNeko&#39;s World</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    
    <script src="/libs/jquery/jquery.min.js"></script>
    
<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/kuroneko_blog/atom.xml" title="KuroNekoNeko's World" type="application/atom+xml">
<link rel="stylesheet" href="/kuroneko_blog/css/prism-tomorrow.css" type="text/css"></head>


<body>
<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper head-container">
            <div class="brand-logo">
                <a href="/kuroneko_blog/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">KuroNekoNeko's World</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">KuroNekoNeko's World</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/kuronekonano/kuronekonano.github.io" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/kuronekonano/kuronekonano.github.io" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>


    <script src="/libs/cryptojs/crypto-js.min.js"></script>
    <script>
        (function () {
            let pwd = '';
            if (pwd && pwd.length > 0) {
                if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                    alert('密码错误，将返回主页！');
                    location.href = '/kuroneko_blog/';
                }
            }
        })();
    </script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/18.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">Python实现可视化界面多线程豆瓣电影信息爬虫，并绘制统计图分析结果</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
        <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        height: calc(100vh - 250px);
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/kuroneko_blog/tags/scrapy/">
                                <span class="chip bg-color">scrapy</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-01-08
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2021-03-07
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    9.7k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    46 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>

        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>完整代码见链接：<a href="https://github.com/kuronekonano/python_scrapy_movie" target="_blank" rel="noopener">https://github.com/kuronekonano/python_scrapy_movie</a><br>实现时使用<strong>图形界面、多线程、文件操作、数据库编程、网络编程、统计绘图</strong>六项技术。<br><strong>1. 数据采集</strong><br>（1）用wxPython实现GUI界面，包括<strong>登录界面</strong>、<strong>爬虫界面</strong>。爬虫界面上包含：<br>1）<strong>复选框</strong>：选择网站页面上要爬取的元素,包括电影名、评论、导演、主演、论坛讨论、电影别名；<br>2）<strong>下拉列表</strong>：选择开启几个多线程进行爬虫，选择爬取电影类型，排序方式<br>3）<strong>scrolledtext</strong>：爬虫结果汇总，包括运行时间，爬取结果，运行状态，爬取数量 等数据；<br>（2）以豆瓣电影为主页面爬取数据深入页面三个层次。并采取多线程方式实现爬虫。<br><strong>第一层次</strong>：电影分类列表，包括标签热门、最新、经典、可播放、豆瓣高分、冷门佳片、华语、欧美、韩国、日本、动作、喜剧、爱情、科幻、悬疑、恐怖、动画，并有三个可选择电影排列顺序：评价、最新、时间<br><strong>第二层次</strong>：电影的详细信息，包括上映年份、片名、导演、编剧、主演、类型、制片国家地区、语言、上映日期、片长、别名、IMDB编号、评分、评价人数、页面网址<br><strong>第三层次</strong>：包括该电影的短评、论坛讨论标题、爬取电影主演个人信息，包括姓名、性别、星座、出生日期、出生地、职业、简介信息<br>（3）将爬取的数据<strong>存储至数据库</strong>中。并将<strong>爬虫日志</strong>（本次数据采集起止时间、采用的线程数、爬取多少条数据，总共用时多长时间等）写到文件中。</p>
<p><strong>2. 数据分析</strong><br>数据统计分析：<br>分析爬取的数据中悬疑类、剧情类、恐怖类的电影所占比例是多少，并用<strong>直方图、饼图</strong>展示结果。<br>对爬取过程中产生的数据进行分析：<br>同样为3线程数条件下，爬取数据条数与所用时长间的<strong>散点关系图</strong>；爬取数据条数同样为40条时，使用线程数与所用时长间的关系图；得出结论，线程数一定时，时间与数量成正比，数量一定时，线程数和时间成反比。</p>
<p>这个程序是我们期末Python大作业的要求。</p>
<p>其实很大程度上的要求是一学期以来做的各种作业，相当于把一学期的作业整合起来做个大的东西。</p>
<p>可是在程序结构上从零开始还是毫无头绪的。</p>
<p>首先分为大致几个结构：</p>
<p>登陆界面的图形化专门在Login_to_Spider.py中实现</p>
<p>接下来因为要用到网络编程技术，因此将爬虫程序和图形化界面程序分开，分别作为服务器端和客户端来处理。<br>即爬虫程序：服务器端调用，在KuroNeko_Spider_Server.py中实现<br>爬虫图形化界面：客户端启动，在KuroNeko_Spider_GUI.py中实现</p>
<p>爬虫实现具体方法：Spider_Engine.py</p>
<p>统计图分析结果的图片存储：Save_Show_Pic.py</p>
<p>大致的结构定位，用户登录到客户端中，然后根据客户端界面内的选项设置爬取要求，确定并点击【开始爬虫】按钮后，由客户端整理用户设置的信息，通过socket通信传送至服务器端，服务器端调用爬虫程序，开启多线程爬虫，在爬虫程序中将爬取结果存储到数据库内，并通过socket通信实时反馈给客户端，显示在客户端界面中。最后多个线程完成爬虫任务，给客户端返回结束信息，客户端记录完成时间，并写入日志，一次爬虫操作结束。</p>
<p>在客户端中还直接整合了统计结果绘制统计图的功能。</p>
<p>流程图如下:<br><img src="https://img-blog.csdnimg.cn/20190115150451688.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t1cm9uZWtvbmFubw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>客户端的总体功能结构如下：<br><img src="https://img-blog.csdnimg.cn/20190115150547177.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t1cm9uZWtvbmFubw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>服务器端调用爬虫程序的框架如下：<br><img src="https://img-blog.csdnimg.cn/20190115150645903.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t1cm9uZWtvbmFubw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>以上即确定了程序将要实现的大体结构功能等内容，依据这个可行结构完成实现整个程序。</p>
<p>那么首先要面对的即是图形化界面的代码怎么写，首先，python中用户实现图形化界面的包有两种，即tkinter和wxpython，tkinter说实话是比较好实现的，调用也十分灵活，但是在规模很大的程序上，wxpython有wxFormBuilder这种方便的可视化软件进行设计，自动生成代码，粘上去就可用，因此最后确定使用wxpython来实现。</p>
<p>至于登陆如何实现，在理解代码的基础上，我们都知道所谓登陆注册功能其实就是对数据库中用户表的插入和查询。再完善一些容错处理即可【如未输入密码，输入格式错误等】。</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span>

<span class="token comment" spellcheck="true">###########################################################################</span>
<span class="token comment" spellcheck="true">## Python code generated with wxFormBuilder (version Jun 17 2015)</span>
<span class="token comment" spellcheck="true">## http://www.wxformbuilder.org/</span>
<span class="token comment" spellcheck="true">## by Kuroneko</span>
<span class="token comment" spellcheck="true">## PLEASE DO "NOT" EDIT THIS FILE!</span>
<span class="token comment" spellcheck="true">###########################################################################</span>
<span class="token keyword">import</span> pymysql
<span class="token keyword">import</span> wx
<span class="token keyword">import</span> wx<span class="token punctuation">.</span>xrc

<span class="token comment" spellcheck="true">###########################################################################</span>
<span class="token comment" spellcheck="true">## Class loginFrame</span>
<span class="token comment" spellcheck="true">###########################################################################</span>
<span class="token keyword">import</span> KuroNeko_Spider_GUI

<span class="token keyword">class</span> <span class="token class-name">loginFrame</span> <span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Frame <span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span> self<span class="token punctuation">,</span> parent <span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#框体布局</span>
        wx<span class="token punctuation">.</span>Frame<span class="token punctuation">.</span>__init__ <span class="token punctuation">(</span> self<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> id <span class="token operator">=</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> title <span class="token operator">=</span> u<span class="token string">"KuroNeko_Client——欢迎"</span><span class="token punctuation">,</span> pos <span class="token operator">=</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> size <span class="token operator">=</span> wx<span class="token punctuation">.</span>Size<span class="token punctuation">(</span> <span class="token number">289</span><span class="token punctuation">,</span><span class="token number">153</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> style <span class="token operator">=</span> wx<span class="token punctuation">.</span>DEFAULT_FRAME_STYLE<span class="token operator">|</span>wx<span class="token punctuation">.</span>TAB_TRAVERSAL <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>SetSizeHints<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">170</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        fgSizer6 <span class="token operator">=</span> wx<span class="token punctuation">.</span>FlexGridSizer<span class="token punctuation">(</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        fgSizer6<span class="token punctuation">.</span>SetFlexibleDirection<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>BOTH <span class="token punctuation">)</span>
        fgSizer6<span class="token punctuation">.</span>SetNonFlexibleGrowMode<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>FLEX_GROWMODE_SPECIFIED <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>username_text <span class="token operator">=</span> wx<span class="token punctuation">.</span>StaticText<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"用户名:"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>Size<span class="token punctuation">(</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#用户名标签</span>
        self<span class="token punctuation">.</span>username_text<span class="token punctuation">.</span>Wrap<span class="token punctuation">(</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>username_text<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>username_text<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer6<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>username_text<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_RIGHT<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>username <span class="token operator">=</span> wx<span class="token punctuation">.</span>TextCtrl<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>EmptyString<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>Size<span class="token punctuation">(</span> <span class="token number">150</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#用户名文本框</span>
        fgSizer6<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>username<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>TOP<span class="token operator">|</span>wx<span class="token punctuation">.</span>BOTTOM<span class="token operator">|</span>wx<span class="token punctuation">.</span>LEFT<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>password_text <span class="token operator">=</span> wx<span class="token punctuation">.</span>StaticText<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"密码:"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>Size<span class="token punctuation">(</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#密码标签</span>
        self<span class="token punctuation">.</span>password_text<span class="token punctuation">.</span>Wrap<span class="token punctuation">(</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>password_text<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>password_text<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">219</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer6<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>password_text<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_RIGHT<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>password <span class="token operator">=</span> wx<span class="token punctuation">.</span>TextCtrl<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>EmptyString<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>Size<span class="token punctuation">(</span> <span class="token number">150</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>TE_PASSWORD <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#密码文本框</span>
        fgSizer6<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>password<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>login <span class="token operator">=</span> wx<span class="token punctuation">.</span>Button<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"登录"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>Size<span class="token punctuation">(</span> <span class="token number">80</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>NO_BORDER <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#登陆按钮</span>
        self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">170</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer6<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>login<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_RIGHT<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>register <span class="token operator">=</span> wx<span class="token punctuation">.</span>Button<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"注册"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>Size<span class="token punctuation">(</span> <span class="token number">80</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>NO_BORDER <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#注册按钮</span>
        self<span class="token punctuation">.</span>register<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>register<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">170</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>register<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer6<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>register<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>


        self<span class="token punctuation">.</span>SetSizer<span class="token punctuation">(</span> fgSizer6 <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>Layout<span class="token punctuation">(</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>Centre<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>BOTH <span class="token punctuation">)</span>

        <span class="token comment" spellcheck="true"># Connect Events</span>
        self<span class="token punctuation">.</span>login<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>EVT_BUTTON<span class="token punctuation">,</span> self<span class="token punctuation">.</span>loginFunc <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#登陆按钮监听</span>
        self<span class="token punctuation">.</span>register<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>EVT_BUTTON<span class="token punctuation">,</span> self<span class="token punctuation">.</span>registerFunc <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#注册按钮监听</span>

    <span class="token keyword">def</span> <span class="token function">__del__</span><span class="token punctuation">(</span> self <span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>


    <span class="token comment" spellcheck="true"># Virtual event handlers, overide them in your derived class</span>
    <span class="token keyword">def</span> <span class="token function">loginFunc</span><span class="token punctuation">(</span> self<span class="token punctuation">,</span> event <span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#登录</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#链接数据库</span>
            conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span>password<span class="token operator">=</span><span class="token string">'970922'</span><span class="token punctuation">,</span>db<span class="token operator">=</span><span class="token string">'mytest'</span><span class="token punctuation">)</span>
            cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'数据库连接错误'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>

        username <span class="token operator">=</span> self<span class="token punctuation">.</span>username<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#获取用户输入的用户名</span>
        password <span class="token operator">=</span> self<span class="token punctuation">.</span>password<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#获取输入的密码</span>
        <span class="token keyword">if</span> username <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">and</span> password <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">:</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'用户名密码不能为空'</span><span class="token punctuation">,</span>caption<span class="token operator">=</span><span class="token string">"错误提示"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            sql <span class="token operator">=</span> <span class="token string">'select * from pyuser where user_name="%s"'</span> <span class="token operator">%</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#查询数据库用户表</span>
            cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'系统错误'</span><span class="token punctuation">,</span>caption<span class="token operator">=</span><span class="token string">"错误提示"</span><span class="token punctuation">)</span>

        user <span class="token operator">=</span> cur<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> user <span class="token operator">==</span> None<span class="token punctuation">:</span><span class="token comment" spellcheck="true">#用户名查询为空</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'用户不存在'</span><span class="token punctuation">,</span>caption<span class="token operator">=</span><span class="token string">"错误提示"</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>username<span class="token punctuation">.</span>Clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>password<span class="token punctuation">.</span>Clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>

        <span class="token keyword">if</span> username <span class="token operator">==</span> user<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">and</span> password <span class="token operator">==</span> user<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#查询到用户名并与密码匹配</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">"登陆成功"</span><span class="token punctuation">,</span>caption<span class="token operator">=</span><span class="token string">"登陆成功"</span><span class="token punctuation">)</span>
            spiderClient <span class="token operator">=</span> KuroNeko_Spider_GUI<span class="token punctuation">.</span>SpiderClient<span class="token punctuation">(</span>None<span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>Show<span class="token punctuation">(</span><span class="token boolean">False</span><span class="token punctuation">)</span>
            spiderClient<span class="token punctuation">.</span>Show<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#查询到用户名却与密码不匹配</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'用户名或者密码错误'</span><span class="token punctuation">,</span>caption<span class="token operator">=</span><span class="token string">"错误提示"</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>username<span class="token punctuation">.</span>Clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>password<span class="token punctuation">.</span>Clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>


    <span class="token keyword">def</span> <span class="token function">registerFunc</span><span class="token punctuation">(</span> self<span class="token punctuation">,</span> event <span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#注册</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#链接数据库</span>
            conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span>password<span class="token operator">=</span><span class="token string">'970922'</span><span class="token punctuation">,</span>db<span class="token operator">=</span><span class="token string">'mytest'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
            cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'数据库连接错误'</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>

        username <span class="token operator">=</span> self<span class="token punctuation">.</span>username<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span>
        password <span class="token operator">=</span> self<span class="token punctuation">.</span>password<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> username <span class="token operator">==</span> <span class="token string">""</span> <span class="token operator">and</span> password <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#错误处理</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'用户名密码不能为空'</span><span class="token punctuation">,</span>caption<span class="token operator">=</span><span class="token string">"错误提示"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>

        sql <span class="token operator">=</span> <span class="token string">'insert into pyuser values("%s","%s")'</span> <span class="token operator">%</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span>password<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'注册成功'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#插入用户输入的用户名和密码到数据库中</span>
            self<span class="token punctuation">.</span>username<span class="token punctuation">.</span>Clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>password<span class="token punctuation">.</span>Clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            conn<span class="token punctuation">.</span>rollback<span class="token punctuation">(</span><span class="token punctuation">)</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'用户名已经存在'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#用户名作为主键的数据已经存在，报错</span>
            self<span class="token punctuation">.</span>username<span class="token punctuation">.</span>Clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>password<span class="token punctuation">.</span>Clear<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#测试</span>
    app <span class="token operator">=</span> wx<span class="token punctuation">.</span>App<span class="token punctuation">(</span><span class="token punctuation">)</span>
    LoginFrame <span class="token operator">=</span> loginFrame<span class="token punctuation">(</span>None<span class="token punctuation">)</span>
    LoginFrame<span class="token punctuation">.</span>Show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>MainLoop<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>运行后实现效果：<br><img src="https://img-blog.csdnimg.cn/20190115151631877.png" alt="在这里插入图片描述"></p>
<ol>
<li>整体B/S（客户端/服务器端）结构<br>使用wxpython实现登陆，包括用户名标签，用户名输入文本框，密码标签，密码输入文本框，登陆按钮、注册按钮。在输入相关信息后，点击登陆即链接数据库查询用户名与密码，并判断是否匹配，匹配则调用客户端窗口，否则提示“账号密码错误”。点击注册即可向数据库中插入用户名与密码，并查询是否存在相同用户名，若已存在提示“该用户名已存在”，并可以重新输入用户名与密码进行注册。<br>客户端输入账号密码登陆后进入，整体框架上客户端和服务器端没有代码相互调用上的直接关系。而是由客户端整合用户选择的数据要求通过socket发送至服务器端，由服务器端调用并运行爬虫程序，并将结果存储后发送回客户端。</li>
</ol>
<p>接下来是客户端界面的实现：</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># -*- coding: utf-8 -*-</span>

<span class="token comment" spellcheck="true">###########################################################################</span>
<span class="token comment" spellcheck="true">## Python code generated with wxFormBuilder (version Jun 17 2015)</span>
<span class="token comment" spellcheck="true">## http://www.wxformbuilder.org/</span>
<span class="token comment" spellcheck="true">## by KuroNeko</span>
<span class="token comment" spellcheck="true">## PLEASE DO "NOT" EDIT THIS FILE!</span>
<span class="token comment" spellcheck="true">###########################################################################</span>
<span class="token keyword">import</span> pickle
<span class="token keyword">import</span> socket
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> matplotlib
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> datetime
<span class="token keyword">import</span> pymysql
<span class="token keyword">import</span> xlwt <span class="token keyword">as</span> ExcelWrite
<span class="token keyword">from</span> xlwt <span class="token keyword">import</span> Borders<span class="token punctuation">,</span> XFStyle<span class="token punctuation">,</span> Pattern
<span class="token keyword">import</span> wx
<span class="token keyword">import</span> wx<span class="token punctuation">.</span>xrc
<span class="token keyword">import</span> os
lock_flag <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">###########################################################################</span>
<span class="token comment" spellcheck="true">## Class SpiderClient</span>
<span class="token comment" spellcheck="true">###########################################################################</span>
<span class="token keyword">import</span> Save_Show_Pic
<span class="token keyword">import</span> KuroNeko_Spider_Server
<span class="token keyword">class</span> <span class="token class-name">SpiderClient</span> <span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Frame <span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span> self<span class="token punctuation">,</span> parent <span class="token punctuation">)</span><span class="token punctuation">:</span>
        wx<span class="token punctuation">.</span>Frame<span class="token punctuation">.</span>__init__ <span class="token punctuation">(</span> self<span class="token punctuation">,</span> parent<span class="token punctuation">,</span> id <span class="token operator">=</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> title <span class="token operator">=</span> u<span class="token string">"KuroNeko-Spider_Client"</span><span class="token punctuation">,</span> pos <span class="token operator">=</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> size <span class="token operator">=</span> wx<span class="token punctuation">.</span>Size<span class="token punctuation">(</span> <span class="token number">605</span><span class="token punctuation">,</span><span class="token number">755</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> style <span class="token operator">=</span> wx<span class="token punctuation">.</span>DEFAULT_FRAME_STYLE<span class="token operator">|</span>wx<span class="token punctuation">.</span>TAB_TRAVERSAL <span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true">#主窗口</span>
        self<span class="token punctuation">.</span>toltime <span class="token operator">=</span> <span class="token number">0</span>

        self<span class="token punctuation">.</span>SetSizeHints<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        bSizer5 <span class="token operator">=</span> wx<span class="token punctuation">.</span>BoxSizer<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>VERTICAL <span class="token punctuation">)</span>

        fgSizer7 <span class="token operator">=</span> wx<span class="token punctuation">.</span>FlexGridSizer<span class="token punctuation">(</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        fgSizer7<span class="token punctuation">.</span>SetFlexibleDirection<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>BOTH <span class="token punctuation">)</span>
        fgSizer7<span class="token punctuation">.</span>SetNonFlexibleGrowMode<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>FLEX_GROWMODE_SPECIFIED <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>url_label <span class="token operator">=</span> wx<span class="token punctuation">.</span>StaticText<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"By KuroNeko"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>Size<span class="token punctuation">(</span> <span class="token number">100</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#地址栏标签</span>
        self<span class="token punctuation">.</span>url_label<span class="token punctuation">.</span>Wrap<span class="token punctuation">(</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>url_label<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"Tempus Sans ITC"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>

        fgSizer7<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>url_label<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>movie_url <span class="token operator">=</span> wx<span class="token punctuation">.</span>TextCtrl<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"豆瓣电影————https://movie.douban.com/"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>Size<span class="token punctuation">(</span> <span class="token number">400</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>TE_READONLY <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#地址栏文本框</span>
        self<span class="token punctuation">.</span>movie_url<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_url<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"Tempus Sans ITC"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        fgSizer7<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>movie_url<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>


        bSizer5<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> fgSizer7<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        fgSizer2 <span class="token operator">=</span> wx<span class="token punctuation">.</span>FlexGridSizer<span class="token punctuation">(</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        fgSizer2<span class="token punctuation">.</span>SetFlexibleDirection<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>BOTH <span class="token punctuation">)</span>
        fgSizer2<span class="token punctuation">.</span>SetNonFlexibleGrowMode<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>FLEX_GROWMODE_SPECIFIED <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>type_label <span class="token operator">=</span> wx<span class="token punctuation">.</span>StaticText<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"类别:"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#类别标签</span>
        self<span class="token punctuation">.</span>type_label<span class="token punctuation">.</span>Wrap<span class="token punctuation">(</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>type_label<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>

        fgSizer2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>type_label<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true">#电影分类下拉框</span>
        movie_typeChoices <span class="token operator">=</span> <span class="token punctuation">[</span> u<span class="token string">"热门"</span><span class="token punctuation">,</span> u<span class="token string">"最新"</span><span class="token punctuation">,</span> u<span class="token string">"经典"</span><span class="token punctuation">,</span> u<span class="token string">"可播放"</span><span class="token punctuation">,</span> u<span class="token string">"豆瓣高分"</span><span class="token punctuation">,</span> u<span class="token string">"冷门佳片"</span><span class="token punctuation">,</span> u<span class="token string">"华语"</span><span class="token punctuation">,</span> u<span class="token string">"欧美"</span><span class="token punctuation">,</span> u<span class="token string">"韩国"</span><span class="token punctuation">,</span>u<span class="token string">"日本"</span><span class="token punctuation">,</span> u<span class="token string">"动作"</span><span class="token punctuation">,</span> u<span class="token string">"喜剧"</span><span class="token punctuation">,</span> u<span class="token string">"爱情"</span><span class="token punctuation">,</span> u<span class="token string">"科幻"</span><span class="token punctuation">,</span> u<span class="token string">"悬疑"</span><span class="token punctuation">,</span> u<span class="token string">"恐怖"</span><span class="token punctuation">,</span> u<span class="token string">"动画"</span> <span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>movie_type <span class="token operator">=</span> wx<span class="token punctuation">.</span>Choice<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> movie_typeChoices<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_type<span class="token punctuation">.</span>SetSelection<span class="token punctuation">(</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_type<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"幼圆"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_type<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">253</span><span class="token punctuation">,</span> <span class="token number">142</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_type<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">243</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">222</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>movie_type<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>sort_way <span class="token operator">=</span> wx<span class="token punctuation">.</span>StaticText<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"排序:"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#排序方式标签</span>
        self<span class="token punctuation">.</span>sort_way<span class="token punctuation">.</span>Wrap<span class="token punctuation">(</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>sort_way<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>

        fgSizer2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>sort_way<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        movie_sortChoices <span class="token operator">=</span> <span class="token punctuation">[</span> u<span class="token string">"热度"</span><span class="token punctuation">,</span> u<span class="token string">"时间"</span><span class="token punctuation">,</span> u<span class="token string">"评价"</span> <span class="token punctuation">]</span><span class="token comment" spellcheck="true">#排序方式下拉框</span>
        self<span class="token punctuation">.</span>movie_sort <span class="token operator">=</span> wx<span class="token punctuation">.</span>Choice<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> movie_sortChoices<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_sort<span class="token punctuation">.</span>SetSelection<span class="token punctuation">(</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_sort<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"幼圆"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_sort<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_sort<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">243</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">222</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>movie_sort<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>thread_label <span class="token operator">=</span> wx<span class="token punctuation">.</span>StaticText<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"线程数:"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#线程数标签</span>
        self<span class="token punctuation">.</span>thread_label<span class="token punctuation">.</span>Wrap<span class="token punctuation">(</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>thread_label<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>

        fgSizer2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>thread_label<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        threadNumChoices <span class="token operator">=</span> <span class="token punctuation">[</span> u<span class="token string">"1"</span><span class="token punctuation">,</span> u<span class="token string">"2"</span><span class="token punctuation">,</span> u<span class="token string">"3"</span><span class="token punctuation">,</span> u<span class="token string">"4"</span><span class="token punctuation">,</span> u<span class="token string">"5"</span><span class="token punctuation">,</span>u<span class="token string">"6"</span><span class="token punctuation">,</span>u<span class="token string">"7"</span> <span class="token punctuation">]</span><span class="token comment" spellcheck="true">#线程数量下拉框</span>
        self<span class="token punctuation">.</span>threadNum <span class="token operator">=</span> wx<span class="token punctuation">.</span>Choice<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> threadNumChoices<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>threadNum<span class="token punctuation">.</span>SetSelection<span class="token punctuation">(</span> <span class="token number">2</span> <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#初始化下拉选项</span>
        self<span class="token punctuation">.</span>threadNum<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">92</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"幼圆"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>threadNum<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">243</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">222</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>threadNum<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">192</span><span class="token punctuation">,</span> <span class="token number">243</span><span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>threadNum<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>page_label <span class="token operator">=</span> wx<span class="token punctuation">.</span>StaticText<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"页数:"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#页数标签</span>
        self<span class="token punctuation">.</span>page_label<span class="token punctuation">.</span>Wrap<span class="token punctuation">(</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>page_label<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>

        fgSizer2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>page_label<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>pageNum <span class="token operator">=</span> wx<span class="token punctuation">.</span>TextCtrl<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> <span class="token string">"1"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>Size<span class="token punctuation">(</span> <span class="token number">35</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>TE_CENTRE <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#输入页数文本框</span>
        fgSizer2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>pageNum<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>


        bSizer5<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> fgSizer2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        fgSizer3 <span class="token operator">=</span> wx<span class="token punctuation">.</span>FlexGridSizer<span class="token punctuation">(</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        fgSizer3<span class="token punctuation">.</span>SetFlexibleDirection<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>BOTH <span class="token punctuation">)</span>
        fgSizer3<span class="token punctuation">.</span>SetNonFlexibleGrowMode<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>FLEX_GROWMODE_SPECIFIED <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>get_way <span class="token operator">=</span> wx<span class="token punctuation">.</span>StaticText<span class="token punctuation">(</span>self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"执行方式："</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>get_way<span class="token punctuation">.</span>Wrap<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>get_way<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer3<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>get_way<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

        query_typeChoices <span class="token operator">=</span> <span class="token punctuation">[</span>u<span class="token string">"快速爬虫"</span><span class="token punctuation">,</span> u<span class="token string">"完整爬虫"</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>query_type <span class="token operator">=</span> wx<span class="token punctuation">.</span>Choice<span class="token punctuation">(</span>self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> query_typeChoices<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>query_type<span class="token punctuation">.</span>SetSelection<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>query_type<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"幼圆"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>query_type<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>query_type<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">228</span><span class="token punctuation">,</span> <span class="token number">202</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer3<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>query_type<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>start <span class="token operator">=</span> wx<span class="token punctuation">.</span>Button<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"开始爬虫✔"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>NO_BORDER <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#启动爬虫按钮start</span>
        self<span class="token punctuation">.</span>start<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"幼圆"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>start<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">253</span><span class="token punctuation">,</span> <span class="token number">142</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>start<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">243</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">222</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer3<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>start<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>export <span class="token operator">=</span> wx<span class="token punctuation">.</span>Button<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"导出数据♋"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>NO_BORDER <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#导出数据按钮export</span>
        self<span class="token punctuation">.</span>export<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"幼圆"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>export<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">183</span><span class="token punctuation">,</span> <span class="token number">245</span><span class="token punctuation">,</span> <span class="token number">253</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>export<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">243</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">222</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer3<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>export<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>analyze <span class="token operator">=</span> wx<span class="token punctuation">.</span>Button<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"数据分析图♐"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>NO_BORDER <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#分析数据按钮analyze</span>
        self<span class="token punctuation">.</span>analyze<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"幼圆"</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>analyze<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">177</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">218</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>analyze<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">187</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer3<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>analyze<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>analyze2 <span class="token operator">=</span> wx<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"线程散点图♌"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>NO_BORDER<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 分析数据按钮analyze</span>
        self<span class="token punctuation">.</span>analyze2<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"幼圆"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>analyze2<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>analyze2<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">228</span><span class="token punctuation">,</span> <span class="token number">202</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        fgSizer3<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>analyze2<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>clear <span class="token operator">=</span> wx<span class="token punctuation">.</span>Button<span class="token punctuation">(</span>self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"✘清空✘"</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span>
                                  wx<span class="token punctuation">.</span>NO_BORDER<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>clear<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"幼圆"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>clear<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>clear<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        fgSizer3<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>clear<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>


        bSizer5<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> fgSizer3<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        fgSizer4 <span class="token operator">=</span> wx<span class="token punctuation">.</span>FlexGridSizer<span class="token punctuation">(</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span>
        fgSizer4<span class="token punctuation">.</span>SetFlexibleDirection<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>BOTH <span class="token punctuation">)</span>
        fgSizer4<span class="token punctuation">.</span>SetNonFlexibleGrowMode<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>FLEX_GROWMODE_SPECIFIED <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>log_text <span class="token operator">=</span> wx<span class="token punctuation">.</span>TextCtrl<span class="token punctuation">(</span> self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>EmptyString<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultPosition<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>Size<span class="token punctuation">(</span> <span class="token number">575</span><span class="token punctuation">,</span><span class="token number">520</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>TE_MULTILINE <span class="token punctuation">)</span>
        fgSizer4<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> self<span class="token punctuation">.</span>log_text<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL<span class="token operator">|</span>wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"微软雅黑"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">243</span><span class="token punctuation">,</span> <span class="token number">203</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        bSizer5<span class="token punctuation">.</span>Add<span class="token punctuation">(</span> fgSizer4<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>m_staticText_select <span class="token operator">=</span> wx<span class="token punctuation">.</span>StaticText<span class="token punctuation">(</span>self<span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ID_ANY<span class="token punctuation">,</span> u<span class="token string">"选择内容:"</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>DefaultSize<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 内容标签</span>
        self<span class="token punctuation">.</span>m_staticText_select<span class="token punctuation">.</span>Wrap<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>m_staticText_select<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        fgSizer2<span class="token punctuation">.</span>Add<span class="token punctuation">(</span>self<span class="token punctuation">.</span>m_staticText_select<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> wx<span class="token punctuation">.</span>ALL <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALIGN_CENTER_HORIZONTAL <span class="token operator">|</span> wx<span class="token punctuation">.</span>ALIGN_CENTER_VERTICAL<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>turn_off<span class="token operator">=</span>wx<span class="token punctuation">.</span>CheckBox<span class="token punctuation">(</span>self<span class="token punctuation">,</span>label<span class="token operator">=</span><span class="token string">"关灯"</span><span class="token punctuation">,</span>pos<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">530</span><span class="token punctuation">,</span><span class="token number">25</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>turn_off<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>turn_off<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>turn_off<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>EVT_CHECKBOX<span class="token punctuation">,</span>self<span class="token punctuation">.</span>onChecked<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#关灯事件监听</span>

        self<span class="token punctuation">.</span>movie_name_check <span class="token operator">=</span> wx<span class="token punctuation">.</span>CheckBox<span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'电影名'</span><span class="token punctuation">,</span> pos<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_name_check<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_name_check<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_comment_check <span class="token operator">=</span> wx<span class="token punctuation">.</span>CheckBox<span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'评论'</span><span class="token punctuation">,</span> pos<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_comment_check<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_comment_check<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_director_check <span class="token operator">=</span> wx<span class="token punctuation">.</span>CheckBox<span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'导演'</span><span class="token punctuation">,</span> pos<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">240</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_director_check<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_director_check<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token number">249</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_actor_check <span class="token operator">=</span> wx<span class="token punctuation">.</span>CheckBox<span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'主演'</span><span class="token punctuation">,</span> pos<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">310</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_actor_check<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_actor_check<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">0</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_discussion_check <span class="token operator">=</span> wx<span class="token punctuation">.</span>CheckBox<span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'论坛讨论'</span><span class="token punctuation">,</span> pos<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">390</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_discussion_check<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_discussion_check<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">170</span><span class="token punctuation">,</span> <span class="token number">248</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_anothername_check <span class="token operator">=</span> wx<span class="token punctuation">.</span>CheckBox<span class="token punctuation">(</span>self<span class="token punctuation">,</span> label<span class="token operator">=</span><span class="token string">'电影别名'</span><span class="token punctuation">,</span> pos<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">480</span><span class="token punctuation">,</span><span class="token number">75</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_anothername_check<span class="token punctuation">.</span>SetFont<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Font<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token string">"黑体"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_anothername_check<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_name_check<span class="token punctuation">.</span>SetValue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_comment_check<span class="token punctuation">.</span>SetValue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_director_check<span class="token punctuation">.</span>SetValue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_actor_check<span class="token punctuation">.</span>SetValue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_discussion_check<span class="token punctuation">.</span>SetValue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>movie_anothername_check<span class="token punctuation">.</span>SetValue<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>SetSizer<span class="token punctuation">(</span> bSizer5 <span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>Layout<span class="token punctuation">(</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>Centre<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>BOTH <span class="token punctuation">)</span>

        <span class="token comment" spellcheck="true"># Connect Events</span>
        self<span class="token punctuation">.</span>start<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>EVT_BUTTON<span class="token punctuation">,</span> self<span class="token punctuation">.</span>startSpider <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#点击触发事件，此处是调用类中开始爬虫函数事件</span>
        self<span class="token punctuation">.</span>export<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>EVT_BUTTON<span class="token punctuation">,</span> self<span class="token punctuation">.</span>exportData <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#导出事件监听</span>
        self<span class="token punctuation">.</span>analyze<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>EVT_BUTTON<span class="token punctuation">,</span> self<span class="token punctuation">.</span>analyzeData <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#电影数据分析监听</span>
        self<span class="token punctuation">.</span>analyze2<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span> wx<span class="token punctuation">.</span>EVT_BUTTON<span class="token punctuation">,</span> self<span class="token punctuation">.</span>analyzeData2 <span class="token punctuation">)</span><span class="token comment" spellcheck="true">#日志数据分析监听</span>
        self<span class="token punctuation">.</span>clear<span class="token punctuation">.</span>Bind<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>EVT_BUTTON<span class="token punctuation">,</span>self<span class="token punctuation">.</span>Clear_log<span class="token punctuation">)</span>

        <span class="token comment" spellcheck="true">#movie_type [ u"热门", u"最新", u"经典", u"可播放", u"豆瓣高分", u"冷门佳片", u"华语", u"欧美", u"韩国",u"日本", u"动作", u"喜剧", u"爱情", u"科幻", u"悬疑", u"恐怖", u"动画" ]</span>
        self<span class="token punctuation">.</span>movie_type_list <span class="token operator">=</span> <span class="token punctuation">[</span>
                        <span class="token string">'%E7%83%AD%E9%97%A8'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E6%9C%80%E6%96%B0'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E7%BB%8F%E5%85%B8'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E5%8F%AF%E6%92%AD%E6%94%BE'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E8%B1%86%E7%93%A3%E9%AB%98%E5%88%86'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E5%86%B7%E9%97%A8%E4%BD%B3%E7%89%87'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E5%8D%8E%E8%AF%AD'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E6%AC%A7%E7%BE%8E'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E9%9F%A9%E5%9B%BD'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E6%97%A5%E6%9C%AC'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E5%8A%A8%E4%BD%9C'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E5%96%9C%E5%89%A7'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E7%88%B1%E6%83%85'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E7%A7%91%E5%B9%BB'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E6%82%AC%E7%96%91'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E6%81%90%E6%80%96'</span><span class="token punctuation">,</span>
                        <span class="token string">'%E5%8A%A8%E7%94%BB'</span>
                        <span class="token punctuation">]</span>
        <span class="token comment" spellcheck="true">#movie_sort</span>
        self<span class="token punctuation">.</span>movie_sort_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'recommend'</span><span class="token punctuation">,</span><span class="token string">'time'</span><span class="token punctuation">,</span><span class="token string">'rank'</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">226</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">'>>>>>>>>>>>>>>>>\n'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">'(๑°3°๑)小可爱正在满世界找服务器(｡>∀&lt;｡)...\n'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'localhost'</span><span class="token punctuation">,</span><span class="token number">12306</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"\n找到辣辣辣辣get！٩( 'ω' )و ！！！！！！！\n"</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n"</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>s <span class="token operator">=</span> None
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"error：没找到服务器，可能你没开"</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"\n（╯‵□′）╯︵┴─┴  ...\n"</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"┴─┴︵╰（‵□′╰）    ...\n"</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"竟然没找到!!!∑(°Д°ノ)ノ！！！等会儿再试试(ó﹏ò｡)\n"</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span></code></pre>
<p>以上是客户端界面的标签及功能按键的位置布置</p>
<p>以下即客户端各部分功能实现：</p>
<p>以下代码包括：<br>1.清空数据显示文本框<br>2.关灯<br>3.启动爬虫程序</p>
<pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">__del__</span><span class="token punctuation">(</span> self <span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">Clear_log</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#清空内容显示文本框</span>
        self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>Clear<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">onChecked</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#关灯</span>
        flag<span class="token operator">=</span>self<span class="token punctuation">.</span>turn_off<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> flag<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>movie_url<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">264</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">243</span><span class="token punctuation">,</span> <span class="token number">203</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>movie_url<span class="token punctuation">.</span>SetBackgroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># Virtual event handlers, overide them in your derived class</span>
    <span class="token keyword">def</span> <span class="token function">startSpider</span><span class="token punctuation">(</span> self<span class="token punctuation">,</span> event <span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#点击并开始爬虫，此事件仅仅是为开始爬虫做准备，包括爬虫要求的整理，服务器的链接校验，直到最后才调用了真正启动爬虫的线程</span>
        page_info <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#用于收集要传送的到爬虫服务器的选择信息</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>pageNum<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">""</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#若未能获取到爬取页数，显示错误提示</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'请输入页数'</span><span class="token punctuation">,</span>caption<span class="token operator">=</span><span class="token string">"错误提示"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token keyword">if</span> int<span class="token punctuation">(</span>self<span class="token punctuation">.</span>pageNum<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#若输入页数格式错误，显示错误提示</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'页数应该大于0'</span><span class="token punctuation">,</span>caption<span class="token operator">=</span><span class="token string">"错误提示"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>s <span class="token operator">==</span> None<span class="token punctuation">:</span><span class="token comment" spellcheck="true">#若链接超时则重新链接</span>
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">'>>>>>>>>>>>>>>>>\n'</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">'(๑°3°๑)小可爱又在满世界找服务器(｡>∀&lt;｡)...\n'</span><span class="token punctuation">)</span>
            self<span class="token punctuation">.</span>s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'localhost'</span><span class="token punctuation">,</span><span class="token number">12306</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"\n找到辣辣辣辣get！٩( 'ω' )و ！！！！！！！\n"</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n"</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>s <span class="token operator">=</span> None
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"error：没找到服务器，可能你没开"</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"\n（╯‵□′）╯︵┴─┴  ...\n"</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"┴─┴︵╰（‵□′╰）    ...\n"</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"竟然没找到!!!∑(°Д°ノ)ノ！！！快去检查服务器开没(ó﹏ò｡)\n"</span><span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n"</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span>
        movie_type <span class="token operator">=</span> self<span class="token punctuation">.</span>movie_type_list<span class="token punctuation">[</span>self<span class="token punctuation">.</span>movie_type<span class="token punctuation">.</span>GetSelection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#获取输入的电影标签</span>
        movie_sort <span class="token operator">=</span> self<span class="token punctuation">.</span>movie_sort_list<span class="token punctuation">[</span>self<span class="token punctuation">.</span>movie_sort<span class="token punctuation">.</span>GetSelection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#获取输入的排序方式</span>
        threadNum <span class="token operator">=</span> self<span class="token punctuation">.</span>threadNum<span class="token punctuation">.</span>GetString<span class="token punctuation">(</span>self<span class="token punctuation">.</span>threadNum<span class="token punctuation">.</span>GetSelection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#获取输入的线程数</span>
        pageNum <span class="token operator">=</span> self<span class="token punctuation">.</span>pageNum<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#获取输入的页数</span>
        query_type <span class="token operator">=</span> self<span class="token punctuation">.</span>query_type<span class="token punctuation">.</span>GetSelection<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#获取爬取方式</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'标签:'</span><span class="token punctuation">,</span>movie_type<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#标签</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'排序方式：'</span><span class="token punctuation">,</span>movie_sort<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#排序方式</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'线程数：'</span><span class="token punctuation">,</span>threadNum<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#线程数</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'页数：'</span><span class="token punctuation">,</span>pageNum<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#页数</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'爬虫方式：'</span><span class="token punctuation">,</span>query_type<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#采集方式</span>
        <span class="token comment" spellcheck="true"># page_info[movie_type,movie_sort,threadNum,pageNum,query_type]</span>
        page_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span>movie_type<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#全部打包到要发送的List中</span>
        page_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span>movie_sort<span class="token punctuation">)</span>
        page_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span>threadNum<span class="token punctuation">)</span>
        page_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span>pageNum<span class="token punctuation">)</span>
        page_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span>query_type<span class="token punctuation">)</span>
        page_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>movie_name_check<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#复选框信息</span>
        page_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>movie_director_check<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        page_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>movie_actor_check<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        page_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>movie_anothername_check<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        page_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>movie_comment_check<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        page_info<span class="token punctuation">.</span>append<span class="token punctuation">(</span>self<span class="token punctuation">.</span>movie_discussion_check<span class="token punctuation">.</span>GetValue<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>self<span class="token punctuation">.</span>showLog<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span>page_info<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#开启新线程调用爬虫程序</span>
</code></pre>
<p>此处将用户要求打包通过socket发送到服务器端，之后监听服务器端回传的消息</p>
<pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">showLog</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>page_info<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#真正开始爬虫的函数</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            starttime <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#起始时间</span>
            self<span class="token punctuation">.</span>s<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>page_info<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#转化为byte传输</span>
            flag <span class="token operator">=</span> <span class="token number">0</span><span class="token comment" spellcheck="true">#返回的线程计数</span>
            num<span class="token operator">=</span><span class="token number">0</span>
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                recv_data<span class="token operator">=</span>self<span class="token punctuation">.</span>s<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">10240</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#接收并转码</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>recv_data<span class="token punctuation">)</span>
                <span class="token keyword">if</span> recv_data <span class="token operator">==</span> <span class="token string">"end"</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#结束标志</span>
                    flag <span class="token operator">=</span> flag<span class="token operator">+</span><span class="token number">1</span><span class="token comment" spellcheck="true">#当一个线程返回end时表示线程结束，所有线程结束时退出循环</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span>page_info<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span> flag <span class="token operator">==</span> int<span class="token punctuation">(</span>page_info<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>SetForegroundColour<span class="token punctuation">(</span>wx<span class="token punctuation">.</span>Colour<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#结束爬取标志颜色</span>
                        self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span>recv_data<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#在图形界面中显示结束标志</span>
                        <span class="token keyword">break</span>
                    <span class="token keyword">continue</span>
                self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span>recv_data<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#在图形界面中显示电影信息</span>
                num<span class="token operator">=</span>num<span class="token operator">+</span><span class="token number">1</span>
            endtime <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#结束时间</span>
            self<span class="token punctuation">.</span>toltime <span class="token operator">=</span>  <span class="token punctuation">(</span>endtime <span class="token operator">-</span> starttime<span class="token punctuation">)</span><span class="token punctuation">.</span>seconds
            self<span class="token punctuation">.</span>log_text<span class="token punctuation">.</span>AppendText<span class="token punctuation">(</span><span class="token string">"\n运行耗时:"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>self<span class="token punctuation">.</span>toltime<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"s\n"</span><span class="token punctuation">)</span>

            Clientlog <span class="token operator">=</span> open<span class="token punctuation">(</span><span class="token string">'spider_log.txt'</span><span class="token punctuation">,</span> <span class="token string">'ba+'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#写入日志</span>
            Clientlog<span class="token punctuation">.</span>write<span class="token punctuation">(</span>str<span class="token punctuation">(</span><span class="token string">"\t*****爬虫日志*****\t\n"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            Clientlog<span class="token punctuation">.</span>write<span class="token punctuation">(</span>str<span class="token punctuation">(</span><span class="token string">"[开始时间]"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>starttime<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y/%m/%d %H:%M:%S'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            Clientlog<span class="token punctuation">.</span>write<span class="token punctuation">(</span>str<span class="token punctuation">(</span><span class="token string">"[结束时间]"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>endtime<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y/%m/%d %H:%M:%S'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            Clientlog<span class="token punctuation">.</span>write<span class="token punctuation">(</span>str<span class="token punctuation">(</span><span class="token string">"[线程数]"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>page_info<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            Clientlog<span class="token punctuation">.</span>write<span class="token punctuation">(</span>str<span class="token punctuation">(</span><span class="token string">"[爬取数据量]"</span><span class="token operator">+</span>str<span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Clientlog<span class="token punctuation">.</span>write<span class="token punctuation">(</span>str<span class="token punctuation">(</span><span class="token string">"[总耗时]"</span><span class="token operator">+</span>str<span class="token punctuation">(</span><span class="token punctuation">(</span>endtime <span class="token operator">-</span> starttime<span class="token punctuation">)</span><span class="token punctuation">.</span>seconds<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'s\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span>password<span class="token operator">=</span><span class="token string">'970922'</span><span class="token punctuation">,</span>db<span class="token operator">=</span><span class="token string">'mytest'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
            cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            sql <span class="token operator">=</span> <span class="token string">'insert into data_log values(null ,"%s","%s","%s")'</span> <span class="token operator">%</span> <span class="token punctuation">(</span>num<span class="token punctuation">,</span><span class="token punctuation">(</span>endtime <span class="token operator">-</span> starttime<span class="token punctuation">)</span><span class="token punctuation">.</span>seconds<span class="token punctuation">,</span>page_info<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'采集启动失败！！！'</span><span class="token punctuation">,</span>caption<span class="token operator">=</span><span class="token string">"错误提示"</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#注意这个链接是爬完一次就直接关掉的，而不是被归到except下面，否则会直接导致第二次爬虫无限等待因为上一次爬虫仍然占用原端口</span>
        self<span class="token punctuation">.</span>s <span class="token operator">=</span> None</code></pre>
<p>4.导出数据功能，即读取本地数据库信息并写入到Excel表格中</p>
<pre class=" language-python"><code class="language-python">
    <span class="token keyword">def</span> <span class="token function">exportData</span><span class="token punctuation">(</span> self<span class="token punctuation">,</span> event <span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#导出数据库中电影信息</span>
        savePath <span class="token operator">=</span> self<span class="token punctuation">.</span>GetDesktopPath<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"\\豆瓣电影信息.xls"</span>
        threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>self<span class="token punctuation">.</span>writeXls<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span>savePath<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#线程写入Excel表格</span>

    <span class="token keyword">def</span> <span class="token function">writeXls</span><span class="token punctuation">(</span>self <span class="token punctuation">,</span>file_name<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#写入Excel表格</span>
        movie_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'上映年份'</span><span class="token punctuation">,</span><span class="token string">'片名'</span><span class="token punctuation">,</span><span class="token string">'导演'</span><span class="token punctuation">,</span><span class="token string">'编剧'</span><span class="token punctuation">,</span><span class="token string">'主演'</span><span class="token punctuation">,</span><span class="token string">'类型'</span><span class="token punctuation">,</span><span class="token string">'制片国家地区'</span><span class="token punctuation">,</span><span class="token string">'语言'</span><span class="token punctuation">,</span><span class="token string">'又名'</span><span class="token punctuation">,</span><span class="token string">'上映日期'</span><span class="token punctuation">,</span><span class="token string">'片长'</span><span class="token punctuation">,</span><span class="token string">'IMDB链接/影片地址'</span><span class="token punctuation">,</span><span class="token string">'评分'</span><span class="token punctuation">,</span><span class="token string">'评价人数'</span><span class="token punctuation">,</span><span class="token string">'页面网址'</span><span class="token punctuation">,</span><span class="token string">'短评'</span><span class="token punctuation">,</span><span class="token string">'话题'</span><span class="token punctuation">]</span>
        xls <span class="token operator">=</span> ExcelWrite<span class="token punctuation">.</span>Workbook<span class="token punctuation">(</span><span class="token punctuation">)</span>
        sheet <span class="token operator">=</span> xls<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#写入表1</span>
        style <span class="token operator">=</span> XFStyle<span class="token punctuation">(</span><span class="token punctuation">)</span>
        pattern <span class="token operator">=</span> Pattern<span class="token punctuation">(</span><span class="token punctuation">)</span>                 <span class="token comment" spellcheck="true"># 创建一个模式</span>
        pattern<span class="token punctuation">.</span>pattern <span class="token operator">=</span> Pattern<span class="token punctuation">.</span>SOLID_PATTERN     <span class="token comment" spellcheck="true"># 设置其模式为实型</span>
        pattern<span class="token punctuation">.</span>pattern_fore_colour <span class="token operator">=</span> <span class="token number">0x16</span>        <span class="token comment" spellcheck="true">#设置其模式单元格背景色</span>
        <span class="token comment" spellcheck="true"># 设置单元格背景颜色 0 = Black, 1 = White, 2 = Red, 3 = Green, 4 = Blue, 5 = Yellow, 6 = Magenta,  the list goes on...</span>
        style<span class="token punctuation">.</span>pattern <span class="token operator">=</span> pattern
        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>movie_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#写入首行信息，为表头，表示列名</span>
            sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span>movie_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>style<span class="token punctuation">)</span>
            sheet<span class="token punctuation">.</span>col<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">5240</span>

        actors_list<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'姓名'</span><span class="token punctuation">,</span><span class="token string">'性别'</span><span class="token punctuation">,</span><span class="token string">'星座'</span><span class="token punctuation">,</span><span class="token string">'年龄'</span><span class="token punctuation">,</span><span class="token string">'出生地'</span><span class="token punctuation">,</span><span class="token string">'职业'</span><span class="token punctuation">,</span><span class="token string">'简介'</span><span class="token punctuation">]</span>
        sheet2<span class="token operator">=</span>xls<span class="token punctuation">.</span>add_sheet<span class="token punctuation">(</span><span class="token string">"Sheet2"</span><span class="token punctuation">)</span>
        style2 <span class="token operator">=</span> XFStyle<span class="token punctuation">(</span><span class="token punctuation">)</span>
        style2<span class="token punctuation">.</span>pattern <span class="token operator">=</span> pattern
        <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>actors_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 写入首行信息，为表头，表示列名</span>
            sheet2<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> actors_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> style2<span class="token punctuation">)</span>
            sheet2<span class="token punctuation">.</span>col<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">5140</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment" spellcheck="true">#连接数据库读取数据</span>
            conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span>password<span class="token operator">=</span><span class="token string">'970922'</span><span class="token punctuation">,</span>db<span class="token operator">=</span><span class="token string">'mytest'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
            cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            sql <span class="token operator">=</span> <span class="token string">'select * from movies'</span>
            cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            row <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> movie_info <span class="token keyword">in</span> cur<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#遍历数据库中每行信息，一行表示一部电影的所有信息</span>
                row <span class="token operator">=</span> row<span class="token operator">+</span><span class="token number">1</span><span class="token comment" spellcheck="true">#第0行为表头，不添加数据，因此从第一列开始写入</span>
                <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>movie_info<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#对于一行信息进行遍历，分别存入每列</span>
                    sheet<span class="token punctuation">.</span>write<span class="token punctuation">(</span>row<span class="token punctuation">,</span>i<span class="token punctuation">,</span>movie_info<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

            sql <span class="token operator">=</span> <span class="token string">"select id,name,sex,star,date_format(from_days(to_days(now())-to_days(birthday)),'%Y')+0,place,job,message from actors"</span>
            cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            row <span class="token operator">=</span> <span class="token number">0</span>
            <span class="token keyword">for</span> actor_info <span class="token keyword">in</span> cur<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 遍历数据库中每行信息，一行表示一部电影的所有信息</span>
                row <span class="token operator">=</span> row <span class="token operator">+</span> <span class="token number">1</span>  <span class="token comment" spellcheck="true"># 第0行为表头，不添加数据，因此从第一列开始写入</span>
                <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>actor_info<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 对于一行信息进行遍历，分别存入每列</span>
                    sheet2<span class="token punctuation">.</span>write<span class="token punctuation">(</span>row<span class="token punctuation">,</span> i<span class="token punctuation">,</span> actor_info<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

            xls<span class="token punctuation">.</span>save<span class="token punctuation">(</span>file_name<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#写入完成，存储</span>
            cur<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'数据已导出到桌面！！！'</span><span class="token punctuation">,</span>caption<span class="token operator">=</span><span class="token string">"导出成功"</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'数据导出失败！！！'</span><span class="token punctuation">,</span>caption<span class="token operator">=</span><span class="token string">"导出失败"</span><span class="token punctuation">)</span></code></pre>
<p>5.数据分析功能，可以分析电影信息以及爬虫日志</p>
<pre class=" language-python"><code class="language-python">    <span class="token keyword">def</span> <span class="token function">analyzeData</span><span class="token punctuation">(</span> self<span class="token punctuation">,</span> event <span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#分析数据，参数为调用 &lt;统计电影类型数量> 的函数</span>
        self<span class="token punctuation">.</span>matplotlib_show<span class="token punctuation">(</span>self<span class="token punctuation">.</span>count_type<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">analyzeData2</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> event <span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#分析数据2,日志信息散点图</span>
        self<span class="token punctuation">.</span>matplotlib_show2<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">def</span> <span class="token function">GetDesktopPath</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#获取桌面路径</span>
        <span class="token keyword">return</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>expanduser<span class="token punctuation">(</span><span class="token string">"~"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'Desktop'</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">count_type</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#统计电影类型数量</span>
        conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span>user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span>password<span class="token operator">=</span><span class="token string">'970922'</span><span class="token punctuation">,</span>db<span class="token operator">=</span><span class="token string">'mytest'</span><span class="token punctuation">,</span>port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span>charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true">#从数据库中获取数据</span>
        cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        sql <span class="token operator">=</span> <span class="token string">'select movie_type from movies'</span><span class="token comment" spellcheck="true">#只查询电影0类型</span>
        cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        movie_type_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#存储已知的电影类型</span>
        movie_count_type <span class="token operator">=</span> dict<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#定义字典，表示电影类型对应的数量</span>
        <span class="token keyword">for</span> movie_type_row <span class="token keyword">in</span> cur<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#遍历查询结果</span>
            movie_types <span class="token operator">=</span> movie_type_row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#获取该电影属于哪些分类</span>
            <span class="token comment" spellcheck="true"># print(movie_types)</span>
            movie_type_list <span class="token operator">+=</span> movie_types<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#因为一部电影可能属于多种分类，因此用分隔符 ‘/’ 分开，然后将得到的list全部加入类型list中</span>
        <span class="token keyword">for</span> movie_type <span class="token keyword">in</span> movie_type_list<span class="token punctuation">:</span><span class="token comment" spellcheck="true">#最后将收集到的所有类型进行字典计数</span>
            <span class="token keyword">if</span> movie_type <span class="token operator">not</span> <span class="token keyword">in</span> movie_count_type<span class="token punctuation">:</span><span class="token comment" spellcheck="true">#如果是字典中不存在的类型，那么计数为初始计数为1</span>
                movie_count_type<span class="token punctuation">[</span>movie_type<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                movie_count_type<span class="token punctuation">[</span>movie_type<span class="token punctuation">]</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token comment" spellcheck="true">#否则计数加1</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>movie_count_type<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#输出统计结果</span>
        <span class="token keyword">return</span> movie_count_type<span class="token comment" spellcheck="true">#返回字典</span>

    <span class="token keyword">def</span> <span class="token function">matplotlib_show</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>movie_count_type<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#饼状图、直方图</span>
        <span class="token comment" spellcheck="true">#指定默认字体</span>
        plt<span class="token punctuation">.</span>cla<span class="token punctuation">(</span><span class="token punctuation">)</span>
        matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
        matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.family'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'sans-serif'</span>
        matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'axes.unicode_minus'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>
        count <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#数量</span>
        category <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment" spellcheck="true">#类型</span>
        <span class="token keyword">for</span> movie_type <span class="token keyword">in</span> movie_count_type<span class="token punctuation">:</span><span class="token comment" spellcheck="true">#遍历电影类型计数</span>
            count<span class="token punctuation">.</span>append<span class="token punctuation">(</span>movie_count_type<span class="token punctuation">[</span>movie_type<span class="token punctuation">]</span><span class="token punctuation">)</span>
            category<span class="token punctuation">.</span>append<span class="token punctuation">(</span>str<span class="token punctuation">(</span>movie_type<span class="token punctuation">)</span><span class="token punctuation">)</span>
        new_count<span class="token operator">=</span>count
        y_pos <span class="token operator">=</span> np<span class="token punctuation">.</span>arange<span class="token punctuation">(</span>len<span class="token punctuation">(</span>category<span class="token punctuation">)</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>bar<span class="token punctuation">(</span>y_pos<span class="token punctuation">,</span> count<span class="token punctuation">,</span> align<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.7</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>xticks<span class="token punctuation">(</span>y_pos<span class="token punctuation">,</span> category<span class="token punctuation">)</span>

        <span class="token keyword">for</span> count<span class="token punctuation">,</span> y_pos <span class="token keyword">in</span> zip<span class="token punctuation">(</span>count<span class="token punctuation">,</span> y_pos<span class="token punctuation">)</span><span class="token punctuation">:</span>
            plt<span class="token punctuation">.</span>text<span class="token punctuation">(</span>y_pos<span class="token punctuation">,</span> count<span class="token operator">+</span><span class="token number">0.5</span><span class="token punctuation">,</span> count<span class="token punctuation">,</span>  horizontalalignment<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> verticalalignment<span class="token operator">=</span><span class="token string">'center'</span><span class="token punctuation">,</span> weight<span class="token operator">=</span><span class="token string">'bold'</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">'电影类别数据分析'</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#图标标题</span>
        plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span>u<span class="token string">'电影分类'</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>subplots_adjust<span class="token punctuation">(</span>bottom <span class="token operator">=</span> <span class="token number">0.15</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span>u<span class="token string">'分类出现次数'</span><span class="token punctuation">)</span>

        <span class="token keyword">try</span><span class="token punctuation">:</span>
            savePath <span class="token operator">=</span> self<span class="token punctuation">.</span>GetDesktopPath<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\电影类别数据直方图.png"</span>  <span class="token comment" spellcheck="true"># 将结果图存储到桌面</span>
            plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>savePath<span class="token punctuation">)</span>
            showDataPic <span class="token operator">=</span> Save_Show_Pic<span class="token punctuation">.</span>ShowDataPic<span class="token punctuation">(</span>None<span class="token punctuation">,</span>openPath<span class="token operator">=</span>savePath<span class="token punctuation">)</span>
            showDataPic<span class="token punctuation">.</span>Show<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true"># wx.MessageBox('数据图已导出到桌面！！！', caption="导出成功")</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'数据图导出失败！！！'</span><span class="token punctuation">,</span> caption<span class="token operator">=</span><span class="token string">"导出失败"</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>cla<span class="token punctuation">(</span><span class="token punctuation">)</span>
        sum_count <span class="token operator">=</span> sum<span class="token punctuation">(</span>new_count<span class="token punctuation">)</span>
        sizes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> it <span class="token keyword">in</span> new_count<span class="token punctuation">:</span>
            sizes<span class="token punctuation">.</span>append<span class="token punctuation">(</span>it <span class="token operator">/</span> sum_count<span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>sizes<span class="token punctuation">,</span> explode<span class="token operator">=</span>list<span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> range<span class="token punctuation">(</span>len<span class="token punctuation">(</span>sizes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> labels<span class="token operator">=</span>category<span class="token punctuation">,</span> autopct<span class="token operator">=</span><span class="token string">"%.2f%%"</span><span class="token punctuation">,</span> shadow<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> startangle<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>r<span class="token string">'电影类型比例饼状图'</span><span class="token punctuation">,</span> fontproperties<span class="token operator">=</span><span class="token string">"SimHei"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            savePath <span class="token operator">=</span> self<span class="token punctuation">.</span>GetDesktopPath<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\电影类别数据饼状图.png"</span>  <span class="token comment" spellcheck="true"># 将结果图存储到桌面</span>
            plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>savePath<span class="token punctuation">)</span>
            showDataPic2 <span class="token operator">=</span> Save_Show_Pic<span class="token punctuation">.</span>ShowDataPic<span class="token punctuation">(</span>None<span class="token punctuation">,</span>openPath<span class="token operator">=</span>savePath<span class="token punctuation">)</span>
            showDataPic2<span class="token punctuation">.</span>Show<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'数据图已导出到桌面！！！'</span><span class="token punctuation">,</span> caption<span class="token operator">=</span><span class="token string">"导出成功"</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'数据图导出失败！！！'</span><span class="token punctuation">,</span> caption<span class="token operator">=</span><span class="token string">"导出失败"</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">matplotlib_show2</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#散点图</span>
        conn <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'localhost'</span><span class="token punctuation">,</span> user<span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">,</span> password<span class="token operator">=</span><span class="token string">'970922'</span><span class="token punctuation">,</span> db<span class="token operator">=</span><span class="token string">'mytest'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">3306</span><span class="token punctuation">,</span> charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># 从数据库中获取数据</span>
        cur <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        sql <span class="token operator">=</span> <span class="token string">'select thread_num,times from data_log where data_num>=40 and data_num&lt;=42'</span>  <span class="token comment" spellcheck="true"># 查询爬取相同数据下，线程与时间关系</span>
        cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        thread_nums<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        time_cnt<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> it <span class="token keyword">in</span> cur<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            thread_nums<span class="token punctuation">.</span>append<span class="token punctuation">(</span>it<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            time_cnt<span class="token punctuation">.</span>append<span class="token punctuation">(</span>it<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>cla<span class="token punctuation">(</span><span class="token punctuation">)</span>
        matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.sans-serif'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'SimHei'</span><span class="token punctuation">]</span>
        matplotlib<span class="token punctuation">.</span>rcParams<span class="token punctuation">[</span><span class="token string">'font.family'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'sans-serif'</span>
        plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>r<span class="token string">'线程数-时间散点图（数据量为40~42时）'</span><span class="token punctuation">,</span> fontproperties<span class="token operator">=</span><span class="token string">"SimHei"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>

        plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'线程数量'</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'时间'</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>thread_nums<span class="token punctuation">,</span> time_cnt<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">"#ff1212"</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'*'</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            savePath <span class="token operator">=</span> self<span class="token punctuation">.</span>GetDesktopPath<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\线程-时间数据散点图.png"</span>  <span class="token comment" spellcheck="true"># 将结果图存储到桌面</span>
            plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>savePath<span class="token punctuation">)</span>
            showDataPic2 <span class="token operator">=</span> Save_Show_Pic<span class="token punctuation">.</span>ShowDataPic<span class="token punctuation">(</span>None<span class="token punctuation">,</span> openPath<span class="token operator">=</span>savePath<span class="token punctuation">)</span>
            showDataPic2<span class="token punctuation">.</span>Show<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true"># wx.MessageBox('数据图已导出到桌面！！！', caption="导出成功")</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'数据图导出失败！！！'</span><span class="token punctuation">,</span> caption<span class="token operator">=</span><span class="token string">"导出失败"</span><span class="token punctuation">)</span>

        sql <span class="token operator">=</span> <span class="token string">'select data_num,times from data_log where thread_num=3'</span>  <span class="token comment" spellcheck="true"># 查询爬取相同数据下，线程与时间关系</span>
        cur<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        data_cnt <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        time_cnt2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> it <span class="token keyword">in</span> cur<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            data_cnt<span class="token punctuation">.</span>append<span class="token punctuation">(</span>it<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            time_cnt2<span class="token punctuation">.</span>append<span class="token punctuation">(</span>it<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true"># print(it)</span>
        plt<span class="token punctuation">.</span>cla<span class="token punctuation">(</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>r<span class="token string">'数量-时间散点图（同为3线程数）'</span><span class="token punctuation">,</span> fontproperties<span class="token operator">=</span><span class="token string">"SimHei"</span><span class="token punctuation">,</span> fontsize<span class="token operator">=</span><span class="token number">15</span><span class="token punctuation">)</span>

        plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'电影数量'</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'时间'</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>data_cnt<span class="token punctuation">,</span> time_cnt2<span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">"#ff1212"</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">'+'</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            savePath <span class="token operator">=</span> self<span class="token punctuation">.</span>GetDesktopPath<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\\数量-时间数据散点图.png"</span>  <span class="token comment" spellcheck="true"># 将结果图存储到桌面</span>
            plt<span class="token punctuation">.</span>savefig<span class="token punctuation">(</span>savePath<span class="token punctuation">)</span>
            showDataPic2 <span class="token operator">=</span> Save_Show_Pic<span class="token punctuation">.</span>ShowDataPic<span class="token punctuation">(</span>None<span class="token punctuation">,</span> openPath<span class="token operator">=</span>savePath<span class="token punctuation">)</span>
            showDataPic2<span class="token punctuation">.</span>Show<span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'数据图已导出到桌面！！！'</span><span class="token punctuation">,</span> caption<span class="token operator">=</span><span class="token string">"导出成功"</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            wx<span class="token punctuation">.</span>MessageBox<span class="token punctuation">(</span><span class="token string">'数据图导出失败！！！'</span><span class="token punctuation">,</span> caption<span class="token operator">=</span><span class="token string">"导出失败"</span><span class="token punctuation">)</span>



<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span><span class="token comment" spellcheck="true">#测试</span>
    app <span class="token operator">=</span> wx<span class="token punctuation">.</span>App<span class="token punctuation">(</span><span class="token punctuation">)</span>
    spiderClient <span class="token operator">=</span> SpiderClient<span class="token punctuation">(</span>None<span class="token punctuation">)</span>
    spiderClient<span class="token punctuation">.</span>Show<span class="token punctuation">(</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span>MainLoop<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>2.客户端结构<br>     选择相应爬虫要求，包括爬取类型，排序方式，线程数，页数等信息。点击“启动”开始爬虫，点击“导出数据”将读取数据库内容生成Excel表格。点击“数据分析图”将读取数据库信息，分析整理后制作电影类型饼状图与直方图，点击“线程散点图”将读取数据库信息，制作线程与数据量与时间关系散点图。<br>     客户端在点击启动后将获取所有用户填写的爬虫要求打包成列表，并通过socket发送到服务器端，之后通过socket监听服务器端传回的结果消息，接受结果消息将显示在scrolledtext中汇总。</p>
<p>以上即客户端方面所有内容，</p>
<hr>
<p>以下介绍服务器端内容：<br>服务器是等待客户端发送数据的程序，因此一直通过socket监听端口，一旦受到消息就根据要求调用爬虫程序。</p>
<pre class=" language-python"><code class="language-python"><span class="token keyword">import</span> json
<span class="token keyword">import</span> pickle
<span class="token keyword">import</span> socket
<span class="token keyword">import</span> threading

<span class="token keyword">from</span> Spider_Engine <span class="token keyword">import</span> Spider<span class="token comment" spellcheck="true">#此处导入爬虫模块，也就是说这个爬虫服务必须先开启，并且客户端是通过爬虫服务器来启动和获取爬取结果</span>

<span class="token keyword">class</span> <span class="token class-name">SpiderServer</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">startServer</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"(:з」∠)_服务器：又要起床做事了ヾ(ｏ・ω・)ノ！！！"</span><span class="token punctuation">)</span>
        s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'localhost'</span><span class="token punctuation">,</span><span class="token number">12306</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            conn<span class="token punctuation">,</span>addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#conn用于与客户端进行通信</span>
            page_info <span class="token operator">=</span> conn<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token operator">not</span> page_info<span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>page_info<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#输出从客户端发送过来的爬取要求，读取byte</span>
            page_info <span class="token operator">=</span> pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>page_info<span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true"># page_info[movie_type,movie_sort,threadNum,pageNum,query_type]</span>
            threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>Spider<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>startSpiderInfo<span class="token punctuation">,</span>args<span class="token operator">=</span><span class="token punctuation">(</span>page_info<span class="token punctuation">,</span>conn<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#此处启动线程调用了爬虫模块，并用conn作为参数，使得爬虫模块也能直接与客户端进行通信</span>
            conn<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span><span class="token string">"服务器：我被找到了(｡>∀&lt;｡)！！！\n"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">#以 encoding 指定的编码格式编码字符串</span>
        conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        s<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#开启服务器</span>
<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">'__main__'</span><span class="token punctuation">:</span>
    s <span class="token operator">=</span> SpiderServer<span class="token punctuation">(</span><span class="token punctuation">)</span>
    s<span class="token punctuation">.</span>startServer<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true"># function_name: 需要线程去执行的方法名</span>
<span class="token comment" spellcheck="true"># threading.Thread()创建线程.start()并启动线程</span>
<span class="token comment" spellcheck="true"># args: 线程执行方法接收的参数，该属性是一个元组，如果只有一个参数也需要在末尾加逗号</span></code></pre>
<p>服务器端只是作为一个爬虫请求的管理功能，并不具备爬虫功能，在需要的时候启动爬虫程序才是服务器的真正功能，并且爬虫程序的结果反馈给客户端也是由服务器端实现，简单的说即只负责通信。</p>
<p>爬虫程序：<br>初始化部分，包括爬虫程序的头【header】，如果没有头会被网页的反爬机制认出，拒绝访问，并且还要设置相应的时间间隔来防止程序过快的访问页面，被豆瓣反爬机制封掉IP</p>
<pre class=" language-python"><code class="language-python"><span class="token comment" spellcheck="true"># encoding=utf-8</span>
<span class="token comment" spellcheck="true"># by:KuroNeko</span>
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> urllib<span class="token punctuation">.</span>request

<span class="token keyword">import</span> datetime
<span class="token keyword">import</span> pymysql
<span class="token keyword">import</span> json

<span class="token keyword">import</span> time
<span class="token keyword">from</span> lxml <span class="token keyword">import</span> etree

lock <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 数据库的锁，只允许同时有一个线程操作数据库</span>
lock_num <span class="token operator">=</span> threading<span class="token punctuation">.</span>Lock<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 全局变量,爬取电影的计数锁</span>
NUM <span class="token operator">=</span> <span class="token number">0</span>


<span class="token comment" spellcheck="true"># 爬虫客户端爬取模块</span>
<span class="token keyword">class</span> <span class="token class-name">Spider</span><span class="token punctuation">(</span>object<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment" spellcheck="true"># 编辑头。使其不会被网站拦截</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>send_headers <span class="token operator">=</span> <span class="token punctuation">{</span>
            <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36'</span><span class="token punctuation">,</span>
            <span class="token string">'Referer'</span><span class="token punctuation">:</span> <span class="token string">'https://movie.douban.com/explore'</span>
        <span class="token punctuation">}</span>
        self<span class="token punctuation">.</span>hotMovieUrl_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>movieDetailInfo_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">global</span> lock
        <span class="token keyword">global</span> lock_num</code></pre>
<p>豆瓣电影用户需要分类的列表，主要抓取每个电影详细页面的url地址，以供第二层第三层使用</p>
<pre class=" language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># 爬取热门电影列表(参数：电影种类，排序方式，页数)【第一层】</span>
    <span class="token keyword">def</span> <span class="token function">getHotMovieUrlList</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> movie_type<span class="token punctuation">,</span> movie_sort<span class="token punctuation">,</span> pageNum<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> int<span class="token punctuation">(</span>pageNum<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 当页数大于0时才能爬取</span>
            <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>int<span class="token punctuation">(</span>pageNum<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 输出页数</span>
                start <span class="token operator">=</span> i <span class="token operator">*</span> <span class="token number">20</span>
                url <span class="token operator">=</span> <span class="token string">'https://movie.douban.com/j/search_subjects?type=movie&amp;tag='</span> <span class="token operator">+</span> movie_type <span class="token operator">+</span> <span class="token string">'&amp;sort='</span> <span class="token operator">+</span> movie_sort <span class="token operator">+</span> <span class="token string">'&amp;page_limit=20&amp;page_start='</span> <span class="token operator">+</span> str<span class="token punctuation">(</span>
                    start<span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
                <span class="token comment" spellcheck="true"># 使用Request类构建一个完整的请求 增加headers信息</span>
                req <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>Request<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>self<span class="token punctuation">.</span>send_headers<span class="token punctuation">)</span>
                <span class="token comment" spellcheck="true"># 打开url获得响应</span>
                resp <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>req<span class="token punctuation">)</span>
                <span class="token comment" spellcheck="true"># 接受响应信息</span>
                json_data <span class="token operator">=</span> resp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
                <span class="token comment" spellcheck="true"># 将json数据转换成字典</span>
                json_obj <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>
                    json_data<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 转换为字典后，是以列表的方式返回，且这个列表中就一个字典元素：subjects，该字典对应一个列表，这个列表对应一个字典，表示该电影所有信息</span>
                <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> json_obj<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token comment" spellcheck="true"># print(value)</span>
                    <span class="token keyword">for</span> item <span class="token keyword">in</span> value<span class="token punctuation">:</span>
                        <span class="token comment" spellcheck="true"># print(item)#具体电影信息，包括电影名和详细信息的URL地址</span>
                        hotMovie_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
                        hotMovie_dict<span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span> <span class="token operator">=</span> item<span class="token punctuation">[</span><span class="token string">'url'</span><span class="token punctuation">]</span>
                        self<span class="token punctuation">.</span>hotMovieUrl_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>hotMovie_dict<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 页数小于等于0直接返回</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token comment" spellcheck="true"># 返回id+name的list表</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>hotMovieUrl_list</code></pre>
<p>第二层网页以及第三层网页的抓取<br>爬取了电影详细信息【第二层】，主演个人信息【第三层】的数据</p>
<pre class=" language-python"><code class="language-python">    <span class="token comment" spellcheck="true"># 爬取热门电影详细信息【第二层】</span>
    <span class="token keyword">def</span> <span class="token function">getMovieDetailInfo</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> movie_url<span class="token punctuation">,</span> page_info<span class="token punctuation">)</span><span class="token punctuation">:</span>
        movieDetailInfo_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token comment" spellcheck="true"># 存储电影详细信息的字典</span>
        resp <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>movie_url<span class="token punctuation">)</span>
        html_data <span class="token operator">=</span> resp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># 构建xpath</span>
        html <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>html_data<span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># movie_year = soup.find('span', class_='year').text.strip('(').strip(')')</span>
        movie_year <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="content"]/h1/span[2]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 年份</span>
        <span class="token comment" spellcheck="true">#  print(movie_year)</span>
        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_year'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_year
        <span class="token comment" spellcheck="true"># movie_name = soup.find('i',class_='').text.split('的')[0]</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>page_info<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            movie_name <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="content"]/h1/span[1]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 电影名</span>
            <span class="token comment" spellcheck="true">#  print(movie_name)</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_name
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token comment" spellcheck="true"># movie_director</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>page_info<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            movie_director_list <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="info"]/span[1]/span[2]/a/text()'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 导演</span>
            director <span class="token operator">=</span> <span class="token string">""</span>
            <span class="token keyword">for</span> directors <span class="token keyword">in</span> movie_director_list<span class="token punctuation">:</span>
                director <span class="token operator">+=</span> str<span class="token punctuation">(</span>directors<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/"</span>

            movie_director <span class="token operator">=</span> director<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true">#   print(movie_director)</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_director'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_director
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_director'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
        movie_writer_list <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="info"]/span[2]/span[2]/a/text()'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 编剧</span>
        writer <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token keyword">for</span> writers <span class="token keyword">in</span> movie_writer_list<span class="token punctuation">:</span>
            writer <span class="token operator">+=</span> str<span class="token punctuation">(</span>writers<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/"</span>

        movie_writer <span class="token operator">=</span> writer<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># print(movie_writer)</span>
        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_writer'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_writer
        <span class="token comment" spellcheck="true"># movie_actor = //*[@id="info"]/span[3]/span[2]</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>page_info<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            movie_actor_list <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="info"]/span[3]/span[2]/a/text()'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 演员</span>
            actor <span class="token operator">=</span> <span class="token string">""</span>
            <span class="token keyword">for</span> actors <span class="token keyword">in</span> movie_actor_list<span class="token punctuation">:</span>
                actor <span class="token operator">+=</span> str<span class="token punctuation">(</span>actors<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/"</span>

            movie_actor <span class="token operator">=</span> actor<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true">#  print(movie_actor)</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_actor'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_actor
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_actor'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token comment" spellcheck="true"># movie_type = //*[@id="info"]/span[5]</span>
        movie_type_list <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="info"]/span[@property="v:genre"]/text()'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 类型</span>
        type <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token keyword">for</span> types <span class="token keyword">in</span> movie_type_list<span class="token punctuation">:</span>
            type <span class="token operator">+=</span> str<span class="token punctuation">(</span>types<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"/"</span>

        movie_type <span class="token operator">=</span> type<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true">#  print(movie_type)</span>
        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_type
        <span class="token comment" spellcheck="true"># movie_country = //*[@id="info"]/span[7] //*[@id="info"]/span[8]</span>
        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_anotherName'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>  <span class="token comment" spellcheck="true"># 别名</span>
        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_language'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>  <span class="token comment" spellcheck="true"># 语言</span>
        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_country'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>  <span class="token comment" spellcheck="true"># 国家/地区</span>
        movie_attrs <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="info"]/span[@class="pl"]'</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> attr <span class="token keyword">in</span> movie_attrs<span class="token punctuation">:</span>
            <span class="token comment" spellcheck="true"># print(attr.text)</span>
            <span class="token keyword">if</span> attr<span class="token punctuation">.</span>text <span class="token operator">==</span> <span class="token string">'制片国家/地区:'</span> <span class="token operator">and</span> page_info<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
                movie_country <span class="token operator">=</span> attr<span class="token punctuation">.</span>tail<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment" spellcheck="true">#   print(movie_country)</span>
                movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_country'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_country
            <span class="token keyword">if</span> attr<span class="token punctuation">.</span>text <span class="token operator">==</span> <span class="token string">'语言:'</span><span class="token punctuation">:</span>
                movie_language <span class="token operator">=</span> attr<span class="token punctuation">.</span>tail<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment" spellcheck="true">#  print(movie_language)</span>
                movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_language'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_language
            <span class="token keyword">if</span> attr<span class="token punctuation">.</span>text <span class="token operator">==</span> <span class="token string">'又名:'</span><span class="token punctuation">:</span>
                movie_anotherName <span class="token operator">=</span> attr<span class="token punctuation">.</span>tail<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment" spellcheck="true">#  print(movie_anotherName)</span>
                movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_anotherName'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_anotherName

        <span class="token comment" spellcheck="true"># movie_date = //*[@id="info"]/span[10]</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            movie_date <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="info"]/span[@property="v:initialReleaseDate"]/@content'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token comment" spellcheck="true"># print(movie_date)</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_date  <span class="token comment" spellcheck="true"># 上映日期</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_date'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"无上映日期"</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment" spellcheck="true"># movie_time = v:runtime</span>
            movie_time <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="info"]/span[@property="v:runtime"]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token comment" spellcheck="true"># print(movie_time)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            movie_time <span class="token operator">=</span> <span class="token string">"无片长信息"</span>
        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_time'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_time  <span class="token comment" spellcheck="true"># 片长</span>
        <span class="token comment" spellcheck="true"># movie_IMDB = //*[@id="info"]/a</span>
        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_IMDB'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
        movie_IMDB <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="info"]/a[@rel="nofollow" and @target="_blank"]/text()'</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> len<span class="token punctuation">(</span>movie_IMDB<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
            <span class="token comment" spellcheck="true"># print(movie_IMDB)</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_IMDB'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_IMDB<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># IMDB链接</span>
        <span class="token comment" spellcheck="true"># movie_grade =</span>
        movie_grade <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="interest_sectl"]/div[1]/div[2]/strong/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token comment" spellcheck="true"># print(movie_grade)</span>
        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_grade'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_grade  <span class="token comment" spellcheck="true"># 评分</span>
        <span class="token comment" spellcheck="true"># movie_commentsNum = //*[@id="interest_sectl"]/div[1]/div[2]/div/div[2]/a/span</span>
        movie_commentsNum <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="interest_sectl"]/div[1]/div[2]/div/div[2]/a/span/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
        <span class="token comment" spellcheck="true"># print(movie_commentsNum)</span>
        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_commentsNum'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_commentsNum  <span class="token comment" spellcheck="true"># 评价人数</span>
        <span class="token comment" spellcheck="true"># movie_pageUrl = movie_url</span>
        movie_pageUrl <span class="token operator">=</span> movie_url
        <span class="token comment" spellcheck="true"># print(movie_pageUrl)</span>
        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_pageUrl'</span><span class="token punctuation">]</span> <span class="token operator">=</span> movie_pageUrl  <span class="token comment" spellcheck="true"># 电影详情页面URL地址</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>page_info<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_comment'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>get_comments<span class="token punctuation">(</span>movie_url <span class="token operator">+</span> <span class="token string">'comments?status=F'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 短评</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_comment'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token comment" spellcheck="true"># print(movieDetailInfo_dict['movie_comment'])</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>page_info<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_discussion'</span><span class="token punctuation">]</span> <span class="token operator">=</span> self<span class="token punctuation">.</span>get_discussion<span class="token punctuation">(</span>movie_url <span class="token operator">+</span> <span class="token string">'discussion/'</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 论坛</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'movie_discussion'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
        <span class="token comment" spellcheck="true"># print(movieDetailInfo_dict['movie_discussion'])</span>

        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'actor_url'</span><span class="token punctuation">]</span> <span class="token operator">=</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="info"]/span[3]/span[2]/a/@href'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># print(movieDetailInfo_dict['actor_url'])</span>
        movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'actor_message'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> it <span class="token keyword">in</span> movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'actor_url'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> page_info<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
            actor_info <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
            actor_info<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
            actor_info<span class="token punctuation">[</span><span class="token string">'sex'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
            actor_info<span class="token punctuation">[</span><span class="token string">'star'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
            actor_info<span class="token punctuation">[</span><span class="token string">'birthday'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
            actor_info<span class="token punctuation">[</span><span class="token string">'place'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
            actor_info<span class="token punctuation">[</span><span class="token string">'job'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
            actor_info<span class="token punctuation">[</span><span class="token string">'message'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">""</span>
            resp2 <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span><span class="token string">'https://movie.douban.com/'</span> <span class="token operator">+</span> it<span class="token punctuation">)</span>
            html_data2 <span class="token operator">=</span> resp2<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
            html2 <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>html_data2<span class="token punctuation">)</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                actor_info<span class="token punctuation">[</span><span class="token string">'name'</span><span class="token punctuation">]</span> <span class="token operator">=</span> html2<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="content"]/h1/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment" spellcheck="true"># 姓名</span>
                actor_info<span class="token punctuation">[</span><span class="token string">'sex'</span><span class="token punctuation">]</span> <span class="token operator">=</span> html2<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="headline"]/div[2]/ul/li[1]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 性别</span>
                actor_info<span class="token punctuation">[</span><span class="token string">'star'</span><span class="token punctuation">]</span> <span class="token operator">=</span> html2<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="headline"]/div[2]/ul/li[2]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 星座</span>
                actor_info<span class="token punctuation">[</span><span class="token string">'birthday'</span><span class="token punctuation">]</span> <span class="token operator">=</span> html2<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="headline"]/div[2]/ul/li[3]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 生日</span>
                actor_info<span class="token punctuation">[</span><span class="token string">'place'</span><span class="token punctuation">]</span> <span class="token operator">=</span> html2<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="headline"]/div[2]/ul/li[4]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 出生地</span>
                actor_info<span class="token punctuation">[</span><span class="token string">'job'</span><span class="token punctuation">]</span> <span class="token operator">=</span> html2<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="headline"]/div[2]/ul/li[5]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 职业</span>
                <span class="token keyword">try</span><span class="token punctuation">:</span>actor_info<span class="token punctuation">[</span><span class="token string">'message'</span><span class="token punctuation">]</span> <span class="token operator">=</span> html2<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="intro"]/div[2]/span[2]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\u3000'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">,</span> replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true"># 简介</span>
                <span class="token keyword">except</span><span class="token punctuation">:</span>actor_info<span class="token punctuation">[</span><span class="token string">'message'</span><span class="token punctuation">]</span> <span class="token operator">=</span> html2<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="intro"]/div[2]/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\u3000'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'https://movie.douban.com/'</span> <span class="token operator">+</span> it<span class="token punctuation">,</span> <span class="token string">'无该演员信息'</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> actor_info<span class="token punctuation">:</span>
                movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'actor_message'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>actor_info<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">pass</span>
            <span class="token keyword">if</span> page_info<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token keyword">break</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>movieDetailInfo_dict<span class="token punctuation">[</span><span class="token string">'actor_message'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token keyword">return</span> movieDetailInfo_dict
        <span class="token comment" spellcheck="true"># 爬取结果是字典，表示单部电影的所有详细信息</span>

    <span class="token keyword">def</span> <span class="token function">get_comments</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> comments_url<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 第一条短评【P为看过，F为想看】</span>
        resp <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>comments_url<span class="token punctuation">)</span>
        html_data <span class="token operator">=</span> resp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># 构建xpath</span>
        html <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>html_data<span class="token punctuation">)</span>
        <span class="token keyword">return</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="comments"]/div[1]/div[2]/p/span/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>

    <span class="token keyword">def</span> <span class="token function">get_discussion</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> discussion_url<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment" spellcheck="true"># 论坛第一条题目</span>
        resp <span class="token operator">=</span> urllib<span class="token punctuation">.</span>request<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>discussion_url<span class="token punctuation">)</span>
        html_data <span class="token operator">=</span> resp<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
        <span class="token comment" spellcheck="true"># 构建xpath</span>
        html <span class="token operator">=</span> etree<span class="token punctuation">.</span>HTML<span class="token punctuation">(</span>html_data<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> html<span class="token punctuation">.</span>xpath<span class="token punctuation">(</span><span class="token string">'//*[@id="posts-table"]//tr[2]/td[1]/a/text()'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">"论坛内容为空"</span></code></pre>
<p>该函数被结果整理函数调用，具体实现了将所有数据存储到本地数据库中，并去重</p>
<pre class=" language-py"><code class="language-py">    # 插入数据库
    def saveDatabase(self, movie_info, conn):
        lock.acquire()
        cur = conn.cursor()
        # print(movie_info['movie_anotherName'],'='*20)
        actor_info = movie_info['actor_message']
        for it in actor_info:
            sql_select = 'select name from actors where name="%s"' % (it['name'])
            cur.execute(sql_select)
            conn.commit()
            check_name = cur.fetchone()
            if check_name == None:
                sql_actor = 'insert into actors values(null,"%s","%s","%s","%s","%s","%s","%s")' % (
                    it['name'], it['sex'], it['star'], it['birthday'], it['place'], it['job'], it['message'])
                try:
                    cur.execute(sql_actor)
                    conn.commit()
                    print(it['name'], '保存成功呢')
                except:
                    print('演员信息不完整')
        try:
            sql_judge = 'select movie_name from movies where movie_name="%s"' % (movie_info['movie_name'])
            cur.execute(sql_judge)
            conn.commit()
            judge_name = cur.fetchone()
            if judge_name == None:
                sql = 'insert into movies values(null ,"%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s")' % (
                    movie_info['movie_year'], movie_info['movie_name'], movie_info['movie_director'],
                    movie_info['movie_writer'], movie_info['movie_actor'], movie_info['movie_type'],
                    movie_info['movie_country'], movie_info['movie_language'], movie_info['movie_anotherName'],
                    movie_info['movie_date'], movie_info['movie_time'], movie_info['movie_IMDB'],
                    movie_info['movie_grade'],
                    movie_info['movie_commentsNum'], movie_info['movie_pageUrl'], movie_info['movie_comment'],
                    movie_info['movie_discussion'])
                cur.execute(sql)
                conn.commit()
                print("保存成功！！！")
        except:
            try:
                sql_judge = 'select movie_name from movies where movie_name="%s"' % (movie_info['movie_name'])
                cur.execute(sql_judge)
                conn.commit()
                judge_name = cur.fetchone()
                if judge_name == None:
                    sql = 'insert into movies values(null ,"%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s","%s")' % (
                        movie_info['movie_year'], movie_info['movie_name'], movie_info['movie_director'],
                        movie_info['movie_writer'], movie_info['movie_actor'], movie_info['movie_type'],
                        movie_info['movie_country'], movie_info['movie_language'], movie_info['movie_anotherName'],
                        movie_info['movie_date'], movie_info['movie_time'], movie_info['movie_IMDB'],
                        movie_info['movie_grade'],
                        movie_info['movie_commentsNum'], movie_info['movie_pageUrl'], "评论存在emoji或未知编码字符",
                        movie_info['movie_discussion'])
                    cur.execute(sql)
                    conn.commit()
                    print("保存成功！！！")
            except:
                print("保存失败！！！")
        lock.release()
        cur.close()
        return movie_info</code></pre>
<p>这是对三层爬取数据结果数据的存储和整理，并通过socket回传给客户端</p>
<pre class=" language-py"><code class="language-py">    def getMovieDetailInfo_list(self, movie_urls, connClient, page_info):
        conn = pymysql.connect(host='localhost', user='root', password='970922', db='mytest', port=3306, charset='utf8')
        for url in movie_urls:
            time.sleep(1)
            movieDetailInfo = self.getMovieDetailInfo(url['url'], page_info)  # 【第二层】爬取详细信息
            movie_info = self.saveDatabase(movieDetailInfo, conn)  # 存储到数据库中
            # movie_info['movie_year'] ,movie_info['movie_name'] ,movie_info['movie_director'] ,movie_info['movie_writer'] ,movie_info['movie_actor']  ,movie_info['movie_type'] ,movie_info['movie_country'] ,    movie_info['movie_language'] ,movie_info['movie_anotherName'] ,    movie_info['movie_date'] ,movie_info['movie_time'] ,movie_info['movie_IMDB'] ,movie_info['movie_grade'] ,movie_info['movie_commentsNum'] ,movie_info['movie_pageUrl']
            lock_num.acquire()
            global NUM
            NUM = NUM + 1
            num = NUM  # 从这里开始构建返回到客户端的信息
            movie_msg = '爬取的第' + str(num) + '条电影信息\n'
            movie_msg += '|' + '>' * 60 + '|\n'
            movie_msg += '【上映年份】' + movie_info['movie_year'] + '\n【片名】' + movie_info['movie_name'] + '\n【导演】' + \
                         movie_info['movie_director'] + '\n【编剧】' + movie_info['movie_writer'] + '\n【主演】' + movie_info[
                             'movie_actor'] + '\n【类型】' + movie_info['movie_type'] + '\n【制片国家地区】' + movie_info[
                             'movie_country'] + '\n【语言】' + movie_info['movie_language'] + '\n【上映日期】' + movie_info[
                             'movie_date'] + '\n【片长】' + movie_info['movie_time'] + '\n【又名】' + movie_info[
                             'movie_anotherName'] + '\n【IMDB链接】' + movie_info['movie_IMDB'] + '\n【评分】' + movie_info[
                             'movie_grade'] + '\n【评价人数】' + movie_info['movie_commentsNum'] + '\n【页面网址】' + movie_info[
                             'movie_pageUrl'] + '\n【短评】' + movie_info['movie_comment'] + '\n【论坛讨论】' + movie_info[
                             'movie_discussion'] + '\n'
            movie_msg += '|' + '<' * 60 + '|\n'
            print(movie_msg)
            lock_num.release()
            threading.Thread(target=connClient.sendall, args=(movie_msg.encode(),)).start()  # 启动线程发送回客户端显示
            print(movie_urls.index(url))
        print('结束')
        connClient.sendall("end".encode())  # 一个线程的结束
        conn.close()</code></pre>
<p>这是被服务器端调用的开始函数，肩负了第一层爬虫的调用以及第二层多线程爬取数据的数量分配</p>
<pre class=" language-py"><code class="language-py">    # page_info[movie_type,movie_sort,threadNum,pageNum,query_type]
    def startSpiderInfo(self, page_info, connClient):  # 此处是被服务器端启动的爬虫线程
        # print(page_info)
        global NUM
        NUM=0
        urls = self.getHotMovieUrlList(page_info[0], page_info[1], page_info[3])  # 首先爬取电影列表【第一层】
        print(urls)  # 返回要爬取详细信息的电影URL列表，是以字典形式存储
        for i in range(int(page_info[2])):  # page_info[2]就是线程数
            time.sleep(1)
            leng = len(urls)
            movie_urls = urls[i * leng // int(page_info[2]):(i + 1) * leng // int(page_info[2])]  # 切片操作，为每个线程平均分配要爬的电影url
            threading.Thread(target=self.getMovieDetailInfo_list, args=(movie_urls, connClient, page_info,)).start()
            # 创建并启动线程，调用获取电影详细信息【第二层】
</code></pre>
<p>实现结果：<br><img src="https://img-blog.csdnimg.cn/20190115155044794.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t1cm9uZWtvbmFubw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<ol start="2">
<li>服务器端结构<br>服务器端作为后台程序状态不显示在客户端中，其结构实现了对客户端访问的监听，并根据指令开始爬虫程序。<br>在客户端发送启动爬虫的指令并发送要求的数据包后，服务器端监听收到消息，并调用spider爬虫主程序。Spider程序中将获取豆瓣电影主页面作为入口地址，并使用单线程获取主页面上所有待爬电影的url地址，存储在列表中。<br>接着遍历该列表，将列表中电影总数平均分成线程数的份数，每个线程被分配到:电影总数/线程数 个电影进行详细页面爬取。<br>在每个线程上，单独对多个电影页面进行爬取，获得的信息存储到字典中，并经过函数整理打包成字符串回传给客户端，并在滑动文本框中显示<br>在回传给客户端之前，服务器端完成了对数据的爬取，分类整理，调用存储函数链接数据库将数据插入到数据库中。并将存储状态，返回给客户端。<br>在结束所有数据爬取后，返回end标志给客户端，客户端计算整个爬虫过程所用时间。并反馈到scrolledtext上，最终记录整个爬虫过程的所有数据写入日志文件中。并连接数据库将相关日志信息插入库中。<br>其中爬取方式有快速爬取及完整爬取，用于对第三层演员个人信息的爬取控制。若选择简单快速爬取，对于一部电影只采集第一位主演的个人信息，考虑到豆瓣网所收集的主演信息并不完整，因此靠后的主演个人信息内容可用性并不高，并且内容缺乏严重，同时，因为对同一部电影深入第三层快速进入多个演职员的个人信息页面，容易触发豆瓣网站的反爬机制，封锁IP，因此若是完整爬取需要对爬取速度进行间歇性暂停控制，这样就造成了完整爬取大量演职员信息时耗费更多时间。考虑到对内容质量以及爬取效率的优化，建议用户使用快速爬取，当然也可以根据个人需要选择完整爬取<br>最后，在数据插入部分，无论是电影信息还是演职员表信息，都对数据进行了重复检测，以防止大量重复数据被在多次爬取时重复插入。</li>
</ol>
<hr>
<p>数据分析图的绘制在客户端中已经写有，以下是对分析的图存储到桌面的过程</p>
<pre class=" language-py"><code class="language-py"># -*- coding: utf-8 -*-
#by KuroNeko
import base64

import os
import wx
from wx.lib.embeddedimage import PyEmbeddedImage


class ShowDataPic ( wx.Frame ):
    def __init__( self, parent ,openPath):#路径参数作为文件名可以直接区分不同的图，以达到重用该存储类
        wx.Frame.__init__ ( self, parent,title = openPath)
        self.SetBackgroundColour( wx.SystemSettings.GetColour( wx.SYS_COLOUR_3DLIGHT ) )
        bSizer1 = wx.BoxSizer( wx.VERTICAL )
        # openPath = self.GetDesktopPath()+"\\电影类别数据分析图.png"#在客户端函数中已经存储了一张图片，现在将结果写入
        file = open(openPath, 'rb')
        str = file.read()
        b64 = base64.b64encode(str)
        file.close()
        bitmap = PyEmbeddedImage(b64).GetBitmap()
        self.m_bitmap1 = wx.StaticBitmap( self, wx.ID_ANY, bitmap )
        bSizer1.Add( self.m_bitmap1, 0, wx.ALL|wx.ALIGN_CENTER_HORIZONTAL, 5 )
        self.SetSizer( bSizer1 )
        self.Layout()
        bSizer1.Fit( self )
        self.Centre( wx.BOTH )
    def GetDesktopPath(self):#再次定义桌面路径
        return os.path.join(os.path.expanduser("~"), 'Desktop')
if __name__=='__main__':
    app = wx.App()
    gui = ShowDataPic(None)
    gui.Show()
    app.MainLoop()</code></pre>
<p>分析结果：<br><img src="https://img-blog.csdnimg.cn/20190115155447196.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t1cm9uZWtvbmFubw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/20190115155457216.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t1cm9uZWtvbmFubw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/20190115155820180.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t1cm9uZWtvbmFubw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190115155835489.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2t1cm9uZWtvbmFubw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://kuronekonano.github.io" rel="external nofollow noreferrer">KuroNeko Nano</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://kuronekonano.github.io/kuroneko_blog/2020/01/08/python-scrapy-movie/">http://kuronekonano.github.io/kuroneko_blog/2020/01/08/python-scrapy-movie/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="http://kuronekonano.github.io" target="_blank">KuroNeko Nano</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/kuroneko_blog/tags/scrapy/">
                                    <span class="chip bg-color">scrapy</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            
        </div>
    </div>

    
        <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: '1078b9784145606ac028',
        clientSecret: 'da1fd72b8f643f35b3a4748e189257e6736617e6',
        repo: 'kuronekonano.github.io',
        owner: 'kuronekonano',
        admin: "kuronekonano",
        id: '2020-01-08T17-46-52',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/kuroneko_blog/2020/01/08/code-interview/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/36.jpg" class="responsive-img" alt="目前为止见到的精妙面试算法题【部分剑指offer原题】">
                        
                        <span class="card-title">目前为止见到的精妙面试算法题【部分剑指offer原题】</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            都是思维题，不容易想到，但是结果非常简单易懂。
题目为：给你1-1000个连续自然数，然后从中随机去掉两个，再打乱顺序，要求只遍历一次，求出被去掉的两个数。使用异或。
说说异或的两个特性：顺序无关 / 对一个数异或两次等于没有异或。顺序无关
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2020-01-08
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            KuroNeko Nano
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/kuroneko_blog/2020/01/08/https-hyper-text-transfer-protocol-over-secure-socket-layer/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/40.jpg" class="responsive-img" alt="HTTPS（Hyper Text Transfer Protocol over Secure Socket Layer +【 中间人攻击  】详解">
                        
                        <span class="card-title">HTTPS（Hyper Text Transfer Protocol over Secure Socket Layer +【 中间人攻击  】详解</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            HTTP即超文本传输协议(HyperText Transfer Protocol) 具有相当优秀和方便的一面。然而方便带来的是简单，越是简单的东西容易被人利用。HTTP在安全性方面基本完全没有防备，安全性的不足导致HTTP容易被窃听，篡改，
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2020-01-08
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            KuroNeko Nano
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/kuroneko_blog/tags/computer-network/">
                        <span class="chip bg-color">computer network</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: KuroNekoNeko&#39;s World<br />'
            + '文章作者: KuroNeko Nano<br />'
            + '文章链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>


<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


<!-- 代码块折行 -->

<style type="text/css">
code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }
</style>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>



<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

<footer class="page-footer bg-color">
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            <span id="year">2019</span>
            <a href="http://kuronekonano.github.io" target="_blank">KuroNeko Nano</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">30.3k</span>&nbsp;字
            
            
            
            
            
            
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                    class="white-color"></span>&nbsp;次
            </span>
            
            
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                    class="white-color"></span>&nbsp;人
            </span>
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2019";
                    var startMonth = "12";
                    var startDate = "31";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/kuronekonano" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:772525182@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>



    <a href="https://www.facebook.com/kuronekonano" class="tooltipped" target="_blank" data-tooltip="关注我的Facebook: https://www.facebook.com/kuronekonano" data-position="top" data-delay="50">
        <i class="fab fa-facebook-f"></i>
    </a>



    <a href="https://twitter.com/kuronekonano1" class="tooltipped" target="_blank" data-tooltip="关注我的Twitter: https://twitter.com/kuronekonano1" data-position="top" data-delay="50">
        <i class="fab fa-twitter"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=772525182" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 772525182" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>



    <a href="https://weibo.com/kuronekonano" class="tooltipped" target="_blank" data-tooltip="关注我的微博: https://weibo.com/kuronekonano" data-position="top" data-delay="50">
        <i class="fab fa-weibo"></i>
    </a>



    <a href="https://www.zhihu.com/people/liu-li-wu-geng/activities" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://www.zhihu.com/people/liu-li-wu-geng/activities" data-position="top" data-delay="50">
        <i class="fab fa-zhihu1">知</i>
    </a>



    <a href="/kuroneko_blog/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>


    <a href="https://steamcommunity.com/profiles/76561198322323726/" class="tooltipped" target="_blank" data-tooltip="关注我的Steam" data-position="top" data-delay="50">
        <i class="fab fa-steam"></i>
    </a>


    <a href="https://my.playstation.com/profile/God772525182" class="tooltipped" target="_blank" data-tooltip="关注我的PSN" data-position="top" data-delay="50">
        <i class="fab fa-playstation"></i>
    </a>


    <a href="https://www.linkedin.com/in/%E6%98%86%E5%87%8C-%E8%94%A1-62233618b/" class="tooltipped" target="_blank" data-tooltip="关注我的Linkedin" data-position="top" data-delay="50">
        <i class="fab fa-linkedin"></i>
    </a>


    <a href="https://www.instagram.com/nano_ruri/?hl=zh-tw" class="tooltipped" target="_blank" data-tooltip="关注我的Instagram" data-position="top" data-delay="50">
        <i class="fab fa-instagram"></i>
    </a>
</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/kuroneko_blog/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


<script src="/libs/materialize/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->


<!-- Baidu Analytics -->

<!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>


    <script src="/libs/others/clicklove.js" async="async"></script>


    <script async src="/libs/others/busuanzi.pure.mini.js"></script>











    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js"
            async="async"></script>



    <script src="/libs/instantpage/instantpage.js" type="module"></script>

<!-- 雪花特效 -->

    <script type="text/javascript" src="/libs/others/snow.js"></script>

<script type="text/javascript"> var OriginTitile = document.title, st;
    document.addEventListener("visibilitychange", function () {
        document.hidden ? (document.title = "Σ(っ °Д °;)っ喔哟，崩溃啦！", clearTimeout(st)) : (document.title = "φ(゜▽゜*)♪咦，又好了！", st = setTimeout(function () {
            document.title = OriginTitile
        }, 3e3))
    }) </script>

<script src="/kuroneko_blog/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/kuroneko_blog/live2dw/assets/haru01.model.json"},"display":{"position":"left","width":200,"height":400,"mobile":{"show":true},"react":{"opacity":0.7}}});</script></body>

</html>
